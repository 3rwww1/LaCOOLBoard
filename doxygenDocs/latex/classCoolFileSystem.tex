\hypertarget{classCoolFileSystem}{}\section{Cool\+File\+System Class Reference}
\label{classCoolFileSystem}\index{Cool\+File\+System@{Cool\+File\+System}}


This class handles the file system.  




{\ttfamily \#include $<$Cool\+File\+System.\+h$>$}



Collaboration diagram for Cool\+File\+System\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=205pt]{classCoolFileSystem__coll__graph}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
bool \hyperlink{classCoolFileSystem_a6ba6f666ed4c530174f8569d2c636748}{begin} ()
\item 
bool \hyperlink{classCoolFileSystem_a32dad79ae80182a83e2e8f52286b7c7b}{update\+Config\+Files} (String answer, int J\+S\+O\+N\+\_\+\+S\+I\+ZE)
\item 
bool \hyperlink{classCoolFileSystem_a4c560c2ddd40b74b7758e6ceb2c58957}{save\+Sensor\+Data} (const char $\ast$data, int Sensor\+\_\+\+J\+S\+O\+N\+\_\+\+S\+I\+ZE)
\item 
bool \hyperlink{classCoolFileSystem_af5a51e2b9bb6e7e7edf75a508fe75f82}{save\+Sensor\+Data\+C\+SV} (const char $\ast$data, int Sensor\+\_\+\+J\+S\+O\+N\+\_\+\+S\+I\+ZE)
\item 
bool \hyperlink{classCoolFileSystem_a5a7eaeea7a9fbf8aaef651d862fa3b5b}{is\+Data\+Saved} ()
\item 
String \hyperlink{classCoolFileSystem_a5c58bca3735c0ed3efb268d70ef998ef}{get\+Sensor\+Saved\+Data} ()
\end{DoxyCompactItemize}
\subsection*{Private Attributes}
\begin{DoxyCompactItemize}
\item 
bool \hyperlink{classCoolFileSystem_ad398e0c5c41a0c88acdf5d672aa71351}{saved\+Data} =0
\end{DoxyCompactItemize}


\subsection{Detailed Description}
This class handles the file system. 

Definition at line 22 of file Cool\+File\+System.\+h.



\subsection{Member Function Documentation}
\mbox{\Hypertarget{classCoolFileSystem_a6ba6f666ed4c530174f8569d2c636748}\label{classCoolFileSystem_a6ba6f666ed4c530174f8569d2c636748}} 
\index{Cool\+File\+System@{Cool\+File\+System}!begin@{begin}}
\index{begin@{begin}!Cool\+File\+System@{Cool\+File\+System}}
\subsubsection{\texorpdfstring{begin()}{begin()}}
{\footnotesize\ttfamily bool Cool\+File\+System\+::begin (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}

\hyperlink{classCoolFileSystem_a6ba6f666ed4c530174f8569d2c636748}{Cool\+File\+System\+::begin()}\+: This method is provided to start the S\+P\+I\+F\+FS object.

\begin{DoxyReturn}{Returns}
true if S\+P\+I\+F\+FS was initialized correctly, false otherwise 
\end{DoxyReturn}


Definition at line 33 of file Cool\+File\+System.\+cpp.



Referenced by Cool\+Board\+::begin(), and Cool\+Board\+::config().


\begin{DoxyCode}
34 \{
35 
36 \textcolor{preprocessor}{#if DEBUG == 1}
37 
38     Serial.println( F(\textcolor{stringliteral}{"Entering CoolFileSystem.begin()"}) );
39     Serial.println();   
40     Serial.print( F(\textcolor{stringliteral}{"SPIFFS success ? "}) );
41     Serial.println(SPIFFS.begin());
42     Serial.println();
43 
44 \textcolor{preprocessor}{#endif}
45 
46     \textcolor{keywordflow}{return}( SPIFFS.begin() );                                   \textcolor{comment}{//Initialize Filesystem}
47 
48 \}
\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classCoolFileSystem_a6ba6f666ed4c530174f8569d2c636748_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classCoolFileSystem_a5c58bca3735c0ed3efb268d70ef998ef}\label{classCoolFileSystem_a5c58bca3735c0ed3efb268d70ef998ef}} 
\index{Cool\+File\+System@{Cool\+File\+System}!get\+Sensor\+Saved\+Data@{get\+Sensor\+Saved\+Data}}
\index{get\+Sensor\+Saved\+Data@{get\+Sensor\+Saved\+Data}!Cool\+File\+System@{Cool\+File\+System}}
\subsubsection{\texorpdfstring{get\+Sensor\+Saved\+Data()}{getSensorSavedData()}}
{\footnotesize\ttfamily String Cool\+File\+System\+::get\+Sensor\+Saved\+Data (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}

Cool\+File\+System\+::get\+Sensor\+Data()\+: This method is provided to return the sensor data saved in the File System

\begin{DoxyReturn}{Returns}
string json of the saved sensor data file 
\end{DoxyReturn}


Definition at line 891 of file Cool\+File\+System.\+cpp.



References saved\+Data.



Referenced by Cool\+Board\+::on\+Line\+Mode().


\begin{DoxyCode}
892 \{
893 
894 \textcolor{preprocessor}{#if DEBUG == 1 }
895 
896     Serial.println( F(\textcolor{stringliteral}{"Entering CoolFileSystem.getSensorSavedData()"}) );
897     Serial.println();
898 
899 \textcolor{preprocessor}{#endif}
900 
901     \textcolor{comment}{//open sensors data file}
902     File sensorsData=SPIFFS.open(\textcolor{stringliteral}{"/sensorsData.json"},\textcolor{stringliteral}{"r"});
903     
904     \textcolor{keywordflow}{if} (!sensorsData)
905     \{
906 
907 \textcolor{preprocessor}{    #if DEBUG == 1 }
908 
909         Serial.println( F(\textcolor{stringliteral}{"Failed to read /sensorsData.json"}) );
910 
911 \textcolor{preprocessor}{    #endif}
912  
913         \textcolor{keywordflow}{return}(\textcolor{stringliteral}{"failed to open file"});
914     \}
915 
916     \textcolor{keywordflow}{else}
917     \{
918         \textcolor{keywordtype}{size\_t} size = sensorsData.size();
919 
920         \textcolor{comment}{// Allocate a buffer to store contents of the file.}
921         std::unique\_ptr < char[] > buf(\textcolor{keyword}{new} \textcolor{keywordtype}{char}[size]);
922 
923         sensorsData.readBytes(buf.get(), size);
924 
925         DynamicJsonBuffer jsonBuffer;
926 
927         JsonObject & json = jsonBuffer.parseObject(buf.get());
928         
929         \textcolor{keywordflow}{if} (!json.success())
930         \{
931 
932 \textcolor{preprocessor}{        #if DEBUG == 1}
933         
934             Serial.println( F(\textcolor{stringliteral}{"failed to parse json"}) );
935         
936 \textcolor{preprocessor}{        #endif}
937         
938             \textcolor{keywordflow}{return}(\textcolor{stringliteral}{"failed to parse json"});
939         \}
940         \textcolor{keywordflow}{else}
941         \{   
942             \textcolor{comment}{//the return string}
943             String sensorDataString;
944             
945             \textcolor{comment}{//print the json to the string}
946             json.printTo(sensorDataString);
947             
948             \textcolor{comment}{//close the file}
949             sensorsData.close();
950 
951             \textcolor{comment}{//delete data in the file}
952             File sensorsData=SPIFFS.open(\textcolor{stringliteral}{"/sensorsData.json"},\textcolor{stringliteral}{"w"});
953             File sensorsDataCSV=SPIFFS.open(\textcolor{stringliteral}{"/sensorsDataCSV.json"},\textcolor{stringliteral}{"w"});
954             \textcolor{keywordflow}{if}( (!sensorsData)||(!sensorsDataCSV) ) 
955             \{
956 \textcolor{preprocessor}{            #if DEBUG == 1}
957         
958                 Serial.println( F(\textcolor{stringliteral}{"failed to delete data in the file"}) );
959         
960 \textcolor{preprocessor}{            #endif}
961 
962                 \textcolor{keywordflow}{return}(\textcolor{stringliteral}{"failed to delete data in the file"});
963             \}
964 
965             sensorsData.close();
966             sensorsDataCSV.close();
967 
968             \textcolor{comment}{//position the saved data flag to false}
969             this->\hyperlink{classCoolFileSystem_ad398e0c5c41a0c88acdf5d672aa71351}{savedData}=\textcolor{keyword}{false}; 
970             
971 \textcolor{preprocessor}{        #if DEBUG == 1 }
972 
973             Serial.println( F(\textcolor{stringliteral}{"saved data : "}) );
974             Serial.println(sensorDataString);
975             Serial.println();
976         
977 \textcolor{preprocessor}{        #endif}
978 
979             \textcolor{comment}{//return the string}
980             \textcolor{keywordflow}{return}(sensorDataString);       
981         \}
982         
983         
984     \}
985 
986 \}
\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classCoolFileSystem_a5c58bca3735c0ed3efb268d70ef998ef_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classCoolFileSystem_a5a7eaeea7a9fbf8aaef651d862fa3b5b}\label{classCoolFileSystem_a5a7eaeea7a9fbf8aaef651d862fa3b5b}} 
\index{Cool\+File\+System@{Cool\+File\+System}!is\+Data\+Saved@{is\+Data\+Saved}}
\index{is\+Data\+Saved@{is\+Data\+Saved}!Cool\+File\+System@{Cool\+File\+System}}
\subsubsection{\texorpdfstring{is\+Data\+Saved()}{isDataSaved()}}
{\footnotesize\ttfamily bool Cool\+File\+System\+::is\+Data\+Saved (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}

\hyperlink{classCoolFileSystem_a5a7eaeea7a9fbf8aaef651d862fa3b5b}{Cool\+File\+System\+::is\+Data\+Saved()}\+: This method is provided to report wether there is sensor data saved in the File System.

\begin{DoxyReturn}{Returns}
true if there is data saved, false otherwise 
\end{DoxyReturn}


Definition at line 868 of file Cool\+File\+System.\+cpp.



References saved\+Data.



Referenced by Cool\+Board\+::on\+Line\+Mode().


\begin{DoxyCode}
869 \{
870 
871 \textcolor{preprocessor}{#if DEBUG == 1 }
872 
873     Serial.println( F(\textcolor{stringliteral}{"Entering CoolFileSystem.isDataSaved()"}) );
874     Serial.println();
875     Serial.print( F(\textcolor{stringliteral}{"savedData : "}) );
876     Serial.println(this->\hyperlink{classCoolFileSystem_ad398e0c5c41a0c88acdf5d672aa71351}{savedData});
877 
878 \textcolor{preprocessor}{#endif}
879 
880     \textcolor{keywordflow}{return}( this->\hyperlink{classCoolFileSystem_ad398e0c5c41a0c88acdf5d672aa71351}{savedData} );
881 \}
\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classCoolFileSystem_a5a7eaeea7a9fbf8aaef651d862fa3b5b_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classCoolFileSystem_a4c560c2ddd40b74b7758e6ceb2c58957}\label{classCoolFileSystem_a4c560c2ddd40b74b7758e6ceb2c58957}} 
\index{Cool\+File\+System@{Cool\+File\+System}!save\+Sensor\+Data@{save\+Sensor\+Data}}
\index{save\+Sensor\+Data@{save\+Sensor\+Data}!Cool\+File\+System@{Cool\+File\+System}}
\subsubsection{\texorpdfstring{save\+Sensor\+Data()}{saveSensorData()}}
{\footnotesize\ttfamily bool Cool\+File\+System\+::save\+Sensor\+Data (\begin{DoxyParamCaption}\item[{const char $\ast$}]{data,  }\item[{int}]{Sensor\+\_\+\+J\+S\+O\+N\+\_\+\+S\+I\+ZE }\end{DoxyParamCaption})}

Cool\+File\+System\+::save\+Sensor\+Data( data, data size )\+: This method is provided to save the data on the local memory when there is no internet available

sets the saved data flag to T\+R\+UE when successful

\begin{DoxyReturn}{Returns}
true if the data was saved, false otherwise 
\end{DoxyReturn}


Definition at line 60 of file Cool\+File\+System.\+cpp.



References saved\+Data, and save\+Sensor\+Data\+C\+S\+V().



Referenced by Cool\+Board\+::off\+Line\+Mode().


\begin{DoxyCode}
61 \{
62 
63 \textcolor{preprocessor}{#if DEBUG == 1}
64 
65     Serial.println( F(\textcolor{stringliteral}{"Entering CoolFileSystem.saveSensorData()"}) );
66     Serial.println();
67 
68 \textcolor{preprocessor}{#endif}
69     
70     File sensorsData=SPIFFS.open(\textcolor{stringliteral}{"/sensorsData.json"},\textcolor{stringliteral}{"a+"});
71     \textcolor{keywordflow}{if}(!sensorsData)
72     \{
73     
74 \textcolor{preprocessor}{    #if DEBUG == 1}
75     
76         Serial.println( F(\textcolor{stringliteral}{"failed to append to /sensorsData.json"}) );
77         Serial.println();
78     
79 \textcolor{preprocessor}{    #endif}
80 
81         this->\hyperlink{classCoolFileSystem_ad398e0c5c41a0c88acdf5d672aa71351}{savedData}=\textcolor{keyword}{false};
82         \textcolor{keywordflow}{return} (\textcolor{keyword}{false}); 
83     \}   
84 
85     DynamicJsonBuffer jsonBuffer(Sensor\_JSON\_SIZE);
86     JsonObject& root = jsonBuffer.parseObject(data);
87 
88     \textcolor{keywordflow}{if}( root.success() )
89     \{
90         root.printTo(sensorsData);
91         sensorsData.println();
92         sensorsData.close();
93 
94 \textcolor{preprocessor}{    #if DEBUG == 1}
95         sensorsData=SPIFFS.open(\textcolor{stringliteral}{"/sensorsData.json"},\textcolor{stringliteral}{"r"});
96         
97         \textcolor{keywordflow}{if}(!sensorsData)
98         \{
99             Serial.println(F(\textcolor{stringliteral}{"failed to reopen /sensorsData.json"}));
100             \textcolor{keywordflow}{return}(\textcolor{keyword}{false});              
101         \}
102     
103         Serial.println( F(\textcolor{stringliteral}{"saved data is : "}) );
104         root.printTo(Serial);
105         Serial.println();
106 
107         Serial.println(F(\textcolor{stringliteral}{"/sensorsData.json"}) );
108         \textcolor{keywordflow}{while} (sensorsData.available()) 
109         \{
110             Serial.println(sensorsData.readString()) ;
111         \}
112         
113         Serial.println();
114         
115         sensorsData.close();
116     
117 \textcolor{preprocessor}{    #endif}
118 
119         this->\hyperlink{classCoolFileSystem_af5a51e2b9bb6e7e7edf75a508fe75f82}{saveSensorDataCSV}(data,Sensor\_JSON\_SIZE);        
120 
121         this->\hyperlink{classCoolFileSystem_ad398e0c5c41a0c88acdf5d672aa71351}{savedData}=\textcolor{keyword}{true};
122         \textcolor{keywordflow}{return} (\textcolor{keyword}{true});      
123     \}
124     \textcolor{keywordflow}{else}
125     \{
126     
127 \textcolor{preprocessor}{    #if DEBUG == 1}
128 
129         Serial.println( F(\textcolor{stringliteral}{"failed to parse json"}) );
130     
131 \textcolor{preprocessor}{    #endif}
132 
133         this->\hyperlink{classCoolFileSystem_ad398e0c5c41a0c88acdf5d672aa71351}{savedData}=\textcolor{keyword}{false};
134         \textcolor{keywordflow}{return}(\textcolor{keyword}{false});
135     \}
136     
137 
138 \}
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classCoolFileSystem_a4c560c2ddd40b74b7758e6ceb2c58957_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classCoolFileSystem_a4c560c2ddd40b74b7758e6ceb2c58957_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classCoolFileSystem_af5a51e2b9bb6e7e7edf75a508fe75f82}\label{classCoolFileSystem_af5a51e2b9bb6e7e7edf75a508fe75f82}} 
\index{Cool\+File\+System@{Cool\+File\+System}!save\+Sensor\+Data\+C\+SV@{save\+Sensor\+Data\+C\+SV}}
\index{save\+Sensor\+Data\+C\+SV@{save\+Sensor\+Data\+C\+SV}!Cool\+File\+System@{Cool\+File\+System}}
\subsubsection{\texorpdfstring{save\+Sensor\+Data\+C\+S\+V()}{saveSensorDataCSV()}}
{\footnotesize\ttfamily bool Cool\+File\+System\+::save\+Sensor\+Data\+C\+SV (\begin{DoxyParamCaption}\item[{const char $\ast$}]{data,  }\item[{int}]{Sensor\+\_\+\+J\+S\+O\+N\+\_\+\+S\+I\+ZE }\end{DoxyParamCaption})}

Cool\+File\+System\+::save\+Sensor\+Data\+C\+S\+V( data, data size )\+: This method is provided to save the data on the local memory in C\+SV format.

\begin{DoxyReturn}{Returns}
true if the data was saved, false otherwise 
\end{DoxyReturn}


Definition at line 149 of file Cool\+File\+System.\+cpp.



Referenced by save\+Sensor\+Data().


\begin{DoxyCode}
150 \{
151 \textcolor{preprocessor}{#if DEBUG == 1}
152 
153     Serial.println( F(\textcolor{stringliteral}{"Entering CoolFileSystem.saveSensorDataCSV()"}) );
154     Serial.println();
155 
156 \textcolor{preprocessor}{#endif}
157     \textcolor{comment}{//parsing json}
158     DynamicJsonBuffer jsonBuffer(Sensor\_JSON\_SIZE);
159     JsonObject& root = jsonBuffer.parseObject(data);
160     String header=\textcolor{stringliteral}{""},values=\textcolor{stringliteral}{""};
161     
162     \textcolor{comment}{//if json parse success}
163     \textcolor{keywordflow}{if}( root.success() )
164     \{       
165         \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} kv : root) 
166         \{
167             \textcolor{comment}{//print the header(json keys ) to header string}
168             header+=kv.key;
169             header+=\textcolor{charliteral}{','};
170             
171             \textcolor{comment}{//print the values to header string}
172             values+=( kv.value.as<\textcolor{keywordtype}{char}*>() );
173             values+=\textcolor{charliteral}{','};
174         \}
175 
176         header.remove(header.lastIndexOf(\textcolor{charliteral}{','}), 1);
177         values.remove(values.lastIndexOf(\textcolor{charliteral}{','}), 1);      
178     
179 \textcolor{preprocessor}{    #if DEBUG == 1}
180     
181         Serial.println( F(\textcolor{stringliteral}{" data is : "}) );
182         root.printTo(Serial);
183         Serial.println();
184         
185         Serial.println(F(\textcolor{stringliteral}{" header is :"} ) ) ;
186         Serial.println(header);
187         Serial.println(F(\textcolor{stringliteral}{" values are : "}));
188         Serial.println(values);
189     
190 \textcolor{preprocessor}{    #endif}
191     
192     \}
193     \textcolor{comment}{//failed to parse json}
194     \textcolor{keywordflow}{else}
195     \{
196     
197 \textcolor{preprocessor}{    #if DEBUG == 1}
198 
199         Serial.println( F(\textcolor{stringliteral}{"failed to parse json"}) );
200     
201 \textcolor{preprocessor}{    #endif}
202 
203         \textcolor{keywordflow}{return}(\textcolor{keyword}{false});
204     \}
205 
206     \textcolor{comment}{//check if file exists}
207     File sensorsData=SPIFFS.open(\textcolor{stringliteral}{"/sensorsData.csv"},\textcolor{stringliteral}{"r"});
208     
209     \textcolor{comment}{//file doesn't exist}
210     \textcolor{keywordflow}{if}(!sensorsData)
211     \{
212     
213 \textcolor{preprocessor}{    #if DEBUG == 1}
214     
215         Serial.println( F(\textcolor{stringliteral}{"/sensorsData.csv not found"}) );
216         Serial.println( F(\textcolor{stringliteral}{"creating /sensorsData.csv"}) );
217         Serial.println();
218     
219 \textcolor{preprocessor}{    #endif}
220         \textcolor{comment}{//create file}
221         sensorsData=SPIFFS.open(\textcolor{stringliteral}{"/sensorsData.csv"},\textcolor{stringliteral}{"w"});
222         
223         \textcolor{keywordflow}{if}(!sensorsData)
224         \{
225 
226 \textcolor{preprocessor}{        #if DEBUG == 1}
227         
228             Serial.println( F(\textcolor{stringliteral}{"failed to create /sensorsData.csv"}) );
229             Serial.println();
230         
231 \textcolor{preprocessor}{        #endif}
232         
233             \textcolor{keywordflow}{return}(\textcolor{keyword}{false});
234 
235         \}
236         
237         \textcolor{comment}{//print the header(json keys ) to the CSV file}
238         sensorsData.println(header);
239 
240         \textcolor{comment}{//print the values to the CSV file}
241         sensorsData.println(values);
242         
243         sensorsData.close();
244     
245 \textcolor{preprocessor}{    #if DEBUG == 1}
246 
247         sensorsData=SPIFFS.open(\textcolor{stringliteral}{"/sensorsData.csv"},\textcolor{stringliteral}{"r"});
248         
249         \textcolor{keywordflow}{if}(!sensorsData)
250         \{
251             Serial.println(F(\textcolor{stringliteral}{"failed to reopen /sensorsData.csv "}));
252             \textcolor{keywordflow}{return}(\textcolor{keyword}{false});      
253         \}
254 
255         Serial.println( F(\textcolor{stringliteral}{"/sensorsData.csv : "}) );
256 
257         \textcolor{keywordflow}{while} (sensorsData.available()) 
258         \{
259             Serial.print(sensorsData.readString()) ;
260         \}
261         Serial.println();
262 
263         \textcolor{comment}{//close the file}
264         sensorsData.close();
265 
266 \textcolor{preprocessor}{    #endif}
267         
268 
269         
270         \textcolor{keywordflow}{return}(\textcolor{keyword}{true});
271         
272     \}
273 
274     \textcolor{comment}{//file exist}
275     \textcolor{keywordflow}{else}
276     \{
277 
278 \textcolor{preprocessor}{    #if DEBUG == 1}
279     
280         Serial.println( F(\textcolor{stringliteral}{"/sensorsData.csv  found"}) );
281         Serial.println( F(\textcolor{stringliteral}{"appending to /sensorsData.csv"}) );
282         Serial.println();
283     
284 \textcolor{preprocessor}{    #endif}
285 
286         \textcolor{comment}{//append to file}
287         sensorsData=SPIFFS.open(\textcolor{stringliteral}{"/sensorsData.csv"},\textcolor{stringliteral}{"a"});
288         
289         \textcolor{keywordflow}{if}(!sensorsData)
290         \{
291         
292 \textcolor{preprocessor}{        #if DEBUG == 1}
293             
294             Serial.println( F(\textcolor{stringliteral}{"failed to open /sensorsData.csv"}) );
295             Serial.println();
296 
297 \textcolor{preprocessor}{        #endif}
298             
299             \textcolor{keywordflow}{return}(\textcolor{keyword}{false});
300         
301         \}
302 
303         \textcolor{comment}{//print the values to the CSV file}
304         sensorsData.println(values);
305         
306         sensorsData.close();
307 
308 \textcolor{preprocessor}{    #if DEBUG == 1}
309 
310         sensorsData=SPIFFS.open(\textcolor{stringliteral}{"/sensorsData.csv"},\textcolor{stringliteral}{"r"});
311         
312         \textcolor{keywordflow}{if}(!sensorsData)
313         \{
314             Serial.println(F(\textcolor{stringliteral}{"failed to reopen /sensorsData.csv "}));
315             \textcolor{keywordflow}{return}(\textcolor{keyword}{false});      
316         \}
317 
318         
319         Serial.println( F(\textcolor{stringliteral}{"/sensorsData.csv : "}) );
320 
321         \textcolor{keywordflow}{while} (sensorsData.available()) 
322         \{
323             Serial.println(sensorsData.readString()) ;
324         \}
325         
326         Serial.println();
327         
328         sensorsData.close();
329         
330 \textcolor{preprocessor}{    #endif      }
331         
332         \textcolor{keywordflow}{return}(\textcolor{keyword}{true});
333     
334     \}   
335 
336 
337 
338 \}
\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classCoolFileSystem_af5a51e2b9bb6e7e7edf75a508fe75f82_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classCoolFileSystem_a32dad79ae80182a83e2e8f52286b7c7b}\label{classCoolFileSystem_a32dad79ae80182a83e2e8f52286b7c7b}} 
\index{Cool\+File\+System@{Cool\+File\+System}!update\+Config\+Files@{update\+Config\+Files}}
\index{update\+Config\+Files@{update\+Config\+Files}!Cool\+File\+System@{Cool\+File\+System}}
\subsubsection{\texorpdfstring{update\+Config\+Files()}{updateConfigFiles()}}
{\footnotesize\ttfamily bool Cool\+File\+System\+::update\+Config\+Files (\begin{DoxyParamCaption}\item[{String}]{answer,  }\item[{int}]{J\+S\+O\+N\+\_\+\+S\+I\+ZE }\end{DoxyParamCaption})}

Cool\+File\+System\+::update\+Config\+Files( mqtt answer, answer size)\+: This method is provided to update the configuration files when the appropriate mqtt answer is received\+: -\/update \+: 1

\begin{DoxyReturn}{Returns}
true if the files are updated correctly, false otherwise 
\end{DoxyReturn}


Definition at line 349 of file Cool\+File\+System.\+cpp.



References temp.



Referenced by Cool\+Board\+::update().


\begin{DoxyCode}
350 \{
351 
352 \textcolor{preprocessor}{#if DEBUG == 1}
353 
354     Serial.println( F(\textcolor{stringliteral}{"Entering CoolFileSystem.updateConfigFiles"}) );
355     Serial.println();
356     
357     Serial.println( F(\textcolor{stringliteral}{"input answer : "}) );
358     Serial.println(answer);
359 \textcolor{preprocessor}{#endif}
360     \textcolor{comment}{//test}
361     \textcolor{keywordtype}{char} buffer[ answer.length()+2 ];
362     answer.toCharArray( buffer, answer.length()+2  );
363     \textcolor{comment}{//total json object }
364     DynamicJsonBuffer jsonBuffer(JSON\_SIZE);
365     JsonObject& root = jsonBuffer.parseObject( buffer );
366 
367 \textcolor{preprocessor}{#if DEBUG == 1}
368 
369     Serial.println( F(\textcolor{stringliteral}{"json object : "}) );  
370     root.printTo(Serial);
371 
372 \textcolor{preprocessor}{#endif}
373 
374     \textcolor{keywordflow}{if}(! ( root.success() ))
375     \{
376     
377 \textcolor{preprocessor}{    #if DEBUG == 1}
378 
379         Serial.println( F(\textcolor{stringliteral}{"failed to parse root "}) );
380         Serial.println();
381     
382 \textcolor{preprocessor}{    #endif}
383 
384         \textcolor{keywordflow}{return}(\textcolor{keyword}{false});
385     \}
386     \textcolor{keywordflow}{else}
387     \{
388 \textcolor{preprocessor}{    #if DEBUG == 1}
389         
390         Serial.println( F(\textcolor{stringliteral}{"success to parse root "}) );
391         Serial.println();
392         
393 \textcolor{preprocessor}{    #endif  }
394     \}
395     
396 \textcolor{preprocessor}{#if DEBUG == 1}
397 
398     Serial.println( F(\textcolor{stringliteral}{"input message is : "}) );
399     root.printTo(Serial);
400     Serial.println();
401 
402 \textcolor{preprocessor}{#endif}
403     \textcolor{comment}{//temp string}
404     String \hyperlink{Irene3000_8h_a5905d48604152cf57aa6bfa087b49173}{temp};
405 
406     \textcolor{comment}{//CoolBoard Configuration File}
407 
408         JsonObject& jsonCoolBoard=root[\textcolor{stringliteral}{"CoolBoard"}];
409 
410 \textcolor{preprocessor}{#if DEBUG == 1}
411 
412     Serial.println( F(\textcolor{stringliteral}{"before config CoolBoard json"}) );
413     jsonCoolBoard.printTo(Serial);
414 
415 \textcolor{preprocessor}{#endif}
416 
417     \textcolor{keywordflow}{if}(jsonCoolBoard.success())
418     \{
419         File coolBoardConfig = SPIFFS.open(\textcolor{stringliteral}{"/coolBoardConfig.json"}, \textcolor{stringliteral}{"w"});   
420         \textcolor{keywordflow}{if}(!coolBoardConfig)
421         \{   
422 \textcolor{preprocessor}{        #if DEBUG == 1}
423             
424             Serial.println( F(\textcolor{stringliteral}{"failed to write to coolBoardConfig.json"}) );
425 
426 \textcolor{preprocessor}{        #endif}
427             \textcolor{keywordflow}{return}(\textcolor{keyword}{false});
428         \}
429         
430         jsonCoolBoard.printTo(coolBoardConfig);
431         
432         coolBoardConfig.close();
433 
434 
435 \textcolor{preprocessor}{    #if DEBUG == 1}
436 
437         Serial.println( F(\textcolor{stringliteral}{"CoolBoard Config"}) );
438         jsonCoolBoard.printTo(Serial);
439         Serial.println();
440     
441 \textcolor{preprocessor}{    #endif}
442         
443     \}
444     \textcolor{keywordflow}{else}
445     \{
446     
447 \textcolor{preprocessor}{    #if DEBUG == 1 }
448 
449         Serial.println( F(\textcolor{stringliteral}{"failed to parse CoolBoard "}) );
450     
451 \textcolor{preprocessor}{    #endif}
452 
453     \}       
454 
455     
456     \textcolor{comment}{//Cool Board Sensors Configuration File}
457         JsonObject& jsonSensorsBoard=root[\textcolor{stringliteral}{"CoolSensorsBoard"}];
458 
459 \textcolor{preprocessor}{#if DEBUG == 1 }
460 
461     Serial.println( F(\textcolor{stringliteral}{"before config CoolSensorsBoard json"}) );
462     jsonSensorsBoard.printTo(Serial);
463 
464 \textcolor{preprocessor}{#endif }
465     
466     \textcolor{keywordflow}{if}(jsonSensorsBoard.success())
467     \{   
468         File coolBoardSensorsConfig = SPIFFS.open(\textcolor{stringliteral}{"/coolBoardSensorsConfig.json"}, \textcolor{stringliteral}{"w"}); 
469         \textcolor{keywordflow}{if}(!coolBoardSensorsConfig)
470         \{
471 \textcolor{preprocessor}{        #if DEBUG == 1 }
472         
473             Serial.println( F(\textcolor{stringliteral}{"failed to write coolBoardSensors.json"}) );
474 
475 \textcolor{preprocessor}{        #endif}
476 
477             \textcolor{keywordflow}{return}(\textcolor{keyword}{false});
478         \}
479         
480         jsonSensorsBoard.printTo(coolBoardSensorsConfig);
481         coolBoardSensorsConfig.close();
482 
483 \textcolor{preprocessor}{    #if DEBUG == 1}
484 
485         Serial.println(\textcolor{stringliteral}{"CoolBoardSensors Config"});
486         jsonSensorsBoard.printTo(Serial);
487         Serial.println();
488 
489 \textcolor{preprocessor}{    #endif}
490 
491     \}
492     \textcolor{keywordflow}{else}
493     \{
494 
495 \textcolor{preprocessor}{    #if DEBUG == 1}
496 
497         Serial.println( F(\textcolor{stringliteral}{"failed to parse CoolSensorsBoard sensors "}) );   
498     
499 \textcolor{preprocessor}{    #endif}
500 
501     \}
502     
503     
504     
505     \textcolor{comment}{//rtc configuration file}
506         JsonObject& jsonRTC=root[\textcolor{stringliteral}{"rtc"}];
507 
508 \textcolor{preprocessor}{#if DEBUG == 1 }
509     
510     Serial.println( F(\textcolor{stringliteral}{"before config rtc json"}) );
511     jsonRTC.printTo(Serial);
512 
513 \textcolor{preprocessor}{#endif}
514     \textcolor{keywordflow}{if}(jsonRTC.success() )
515     \{
516         File rtcConfig = SPIFFS.open(\textcolor{stringliteral}{"/rtcConfig.json"}, \textcolor{stringliteral}{"w"});   
517         \textcolor{keywordflow}{if}(!rtcConfig)
518         \{
519         
520 \textcolor{preprocessor}{        #if DEBUG == 1 }
521 
522             Serial.println( F(\textcolor{stringliteral}{"failed to write rtcConfig.json"}) );
523 
524 \textcolor{preprocessor}{        #endif}
525 
526             \textcolor{keywordflow}{return}(\textcolor{keyword}{false});
527         \}
528 
529         jsonRTC.printTo(rtcConfig);
530         rtcConfig.close();
531 
532 \textcolor{preprocessor}{    #if DEBUG == 1 }
533 
534         Serial.println( F(\textcolor{stringliteral}{"RTC Config"}) );
535         jsonRTC.printTo(Serial);
536         Serial.println();
537     
538 \textcolor{preprocessor}{    #endif}
539 
540     
541     \}
542     \textcolor{keywordflow}{else}
543     \{
544     
545 \textcolor{preprocessor}{    #if DEBUG == 1 }
546 
547         Serial.println( F(\textcolor{stringliteral}{"failed to parse rtc "}) );
548     
549 \textcolor{preprocessor}{    #endif}
550 
551     \}
552 
553     
554     
555     
556     
557         \textcolor{comment}{//cool board led configuration}
558         JsonObject& jsonLedBoard=root[\textcolor{stringliteral}{"led"}];
559     
560 \textcolor{preprocessor}{#if DEBUG == 1 }
561 
562     Serial.println( F(\textcolor{stringliteral}{"before config Led json"}) );
563     jsonLedBoard.printTo(Serial);
564 
565 \textcolor{preprocessor}{#endif}
566 
567     \textcolor{keywordflow}{if}(jsonLedBoard.success())
568     \{   
569         File coolBoardLedConfig = SPIFFS.open(\textcolor{stringliteral}{"/coolBoardLedConfig.json"}, \textcolor{stringliteral}{"w"}); 
570         \textcolor{keywordflow}{if}(!coolBoardLedConfig)
571         \{
572         
573 \textcolor{preprocessor}{        #if DEBUG == 1 }
574         
575             Serial.println( F(\textcolor{stringliteral}{"failed to write led config"}) );
576         
577 \textcolor{preprocessor}{        #endif}
578 
579             \textcolor{keywordflow}{return}(\textcolor{keyword}{false});
580         \}
581         
582         jsonLedBoard.printTo(coolBoardLedConfig);
583         coolBoardLedConfig.close();
584 
585 
586 \textcolor{preprocessor}{    #if DEBUG == 1 }
587 
588         Serial.println( F(\textcolor{stringliteral}{"CoolBoardLed Config"}) );     
589         jsonLedBoard.printTo(Serial);
590         Serial.println();
591     
592 \textcolor{preprocessor}{    #endif}
593 
594     
595     \}
596     \textcolor{keywordflow}{else}
597     \{
598     
599 \textcolor{preprocessor}{    #if DEBUG == 1 }
600 
601         Serial.println( F(\textcolor{stringliteral}{"failed to parse led"}) );
602     
603 \textcolor{preprocessor}{    #endif }
604 
605     \}
606         
607 
608     
609 
610     \textcolor{comment}{//jetpack configuration}
611         JsonObject& jsonJetpack=root[\textcolor{stringliteral}{"jetPack"}];
612 
613 \textcolor{preprocessor}{#if DEBUG == 1 }
614 
615     Serial.println( F(\textcolor{stringliteral}{"before config jetpack json"}) );
616     jsonJetpack.printTo(Serial);
617 
618 \textcolor{preprocessor}{#endif}
619 
620     \textcolor{keywordflow}{if}(jsonJetpack.success())
621     \{   
622         File jetPackConfig = SPIFFS.open(\textcolor{stringliteral}{"/jetPackConfig.json"}, \textcolor{stringliteral}{"w"});   
623         \textcolor{keywordflow}{if}(!jetPackConfig)
624         \{
625 \textcolor{preprocessor}{        #if DEBUG == 1}
626 
627             Serial.println( F(\textcolor{stringliteral}{"failed to write jetpack file"}) );
628         
629 \textcolor{preprocessor}{        #endif}
630 
631             \textcolor{keywordflow}{return}(\textcolor{keyword}{false});
632         \}
633 
634         jsonJetpack.printTo(jetPackConfig);
635         jetPackConfig.close();
636 
637 \textcolor{preprocessor}{    #if DEBUG == 1}
638 
639         Serial.println( F(\textcolor{stringliteral}{"jetpack Config"}) );  
640         jsonJetpack.printTo(Serial);
641         Serial.println();
642     
643 \textcolor{preprocessor}{    #endif}
644 
645     \}
646 
647     \textcolor{keywordflow}{else}
648     \{
649     
650 \textcolor{preprocessor}{    #if DEBUG == 1 }
651 
652         Serial.println( F(\textcolor{stringliteral}{"failed to parse jetpack"}) ); 
653     
654 \textcolor{preprocessor}{    #endif}
655 
656     \}
657     
658     \textcolor{comment}{//irene configuration   }
659         JsonObject& jsonIrene=root[\textcolor{stringliteral}{"irene3000"}];
660     
661 \textcolor{preprocessor}{#if DEBUG == 1 }
662 
663     Serial.println( F(\textcolor{stringliteral}{"before config irene json"}) );    
664     jsonIrene.printTo(Serial);
665 
666 \textcolor{preprocessor}{#endif }
667 
668     \textcolor{keywordflow}{if}(jsonIrene.success())
669     \{
670         File irene3000Config = SPIFFS.open(\textcolor{stringliteral}{"/irene3000Config.json"}, \textcolor{stringliteral}{"w"});   
671         \textcolor{keywordflow}{if}(!irene3000Config)
672         \{
673 
674 \textcolor{preprocessor}{        #if DEBUG == 1 }
675 
676             Serial.println( F(\textcolor{stringliteral}{"failed to write irene file"}) );
677         
678 \textcolor{preprocessor}{        #endif}
679 
680             \textcolor{keywordflow}{return}(\textcolor{keyword}{false});
681         \}
682 
683         jsonIrene.printTo(irene3000Config);
684         irene3000Config.close();
685     
686 \textcolor{preprocessor}{    #if DEBUG == 1 }
687         
688         Serial.println( F(\textcolor{stringliteral}{"irene3000 Config"}) );
689         jsonIrene.printTo(Serial);
690         Serial.println();
691     
692 \textcolor{preprocessor}{    #endif}
693     
694     \}
695     \textcolor{keywordflow}{else}
696     \{
697     
698 \textcolor{preprocessor}{    #if DEBUG == 1 }
699 
700         Serial.println( F(\textcolor{stringliteral}{"failed to parse irene"}) );   
701     
702 \textcolor{preprocessor}{    #endif }
703 
704 
705     \}
706     
707     \textcolor{comment}{//external sensors}
708         JsonObject& jsonExternalSensors=root[\textcolor{stringliteral}{"externalSensors"}];
709 
710 \textcolor{preprocessor}{#if DEBUG == 1 }
711 
712     Serial.println( F(\textcolor{stringliteral}{"before config external Sensors json"}) );
713     jsonExternalSensors.printTo(Serial);
714 
715 \textcolor{preprocessor}{#endif}
716 
717     \textcolor{keywordflow}{if}(jsonExternalSensors.success())
718     \{
719         File externalSensorsConfig = SPIFFS.open(\textcolor{stringliteral}{"/externalSensorsConfig.json"}, \textcolor{stringliteral}{"w"});   
720         \textcolor{keywordflow}{if}(!externalSensorsConfig)
721         \{
722         
723 \textcolor{preprocessor}{        #if DEBUG == 1 }
724 
725             Serial.println( F(\textcolor{stringliteral}{"failed to open external sensors file "}) );
726         
727 \textcolor{preprocessor}{        #endif }
728 
729             \textcolor{keywordflow}{return}(\textcolor{keyword}{false});
730         \}
731 
732         jsonExternalSensors.printTo(externalSensorsConfig); 
733         externalSensorsConfig.close();
734 
735 \textcolor{preprocessor}{#if DEBUG == 1 }
736         
737         Serial.println( F(\textcolor{stringliteral}{"externalSensors Config"}) );
738         jsonExternalSensors.printTo(Serial);
739         Serial.println();
740 
741 \textcolor{preprocessor}{#endif }
742 
743 
744     \}
745 
746     \textcolor{keywordflow}{else}
747     \{   
748 
749 \textcolor{preprocessor}{    #if DEBUG == 1}
750         
751         Serial.println( F(\textcolor{stringliteral}{"failed to parse external sensors"}) );
752 
753 \textcolor{preprocessor}{    #endif}
754 
755 
756     \}
757 
758     
759     \textcolor{comment}{//mqtt config}
760         JsonObject& jsonMQTT=root[\textcolor{stringliteral}{"mqtt"}];
761     
762 \textcolor{preprocessor}{#if DEBUG == 1 }
763 
764     Serial.println( F(\textcolor{stringliteral}{"before config mqtt json"}) );
765     jsonMQTT.printTo(Serial);
766 
767 \textcolor{preprocessor}{#endif}
768 
769     \textcolor{keywordflow}{if}(jsonMQTT.success())
770     \{
771         File mqttConfig = SPIFFS.open(\textcolor{stringliteral}{"/mqttConfig.json"}, \textcolor{stringliteral}{"w"}); 
772         \textcolor{keywordflow}{if}(!mqttConfig)
773         \{
774         
775 \textcolor{preprocessor}{        #if DEBUG == 1 }
776 
777             Serial.println( F(\textcolor{stringliteral}{"failed to open mqtt file "}) );
778         
779 \textcolor{preprocessor}{        #endif}
780         
781             \textcolor{keywordflow}{return}(\textcolor{keyword}{false});
782         \}
783             
784         jsonMQTT.printTo(mqttConfig);
785         mqttConfig.close();
786 
787 \textcolor{preprocessor}{#if DEBUG == 1 }
788 
789         Serial.println( F(\textcolor{stringliteral}{"mqtt config"}) );
790         jsonMQTT.printTo(Serial);
791         Serial.println();
792 
793 \textcolor{preprocessor}{#endif}
794 
795     \}
796     \textcolor{keywordflow}{else}
797     \{
798 
799 \textcolor{preprocessor}{    #if DEBUG == 1 }
800 
801         Serial.println( F(\textcolor{stringliteral}{"failed to parse mqtt"}) );
802     
803 \textcolor{preprocessor}{    #endif}
804 
805     
806     \}   
807 
808     \textcolor{comment}{//wifi config}
809         JsonObject& jsonWifi=root[\textcolor{stringliteral}{"wifi"}];
810     
811 \textcolor{preprocessor}{#if DEBUG == 1 }
812 
813     Serial.println( F(\textcolor{stringliteral}{"before config wifi json"}) );
814     jsonWifi.printTo(Serial);
815 
816 \textcolor{preprocessor}{#endif}
817 
818     \textcolor{keywordflow}{if}(jsonWifi.success())
819     \{
820         File wifiConfig = SPIFFS.open(\textcolor{stringliteral}{"/wifiConfig.json"}, \textcolor{stringliteral}{"w"}); 
821         \textcolor{keywordflow}{if}(!wifiConfig)
822         \{
823         
824 \textcolor{preprocessor}{        #if DEBUG == 1 }
825 
826             Serial.println( F(\textcolor{stringliteral}{"failed to open wifi file "}) );
827         
828 \textcolor{preprocessor}{        #endif}
829         
830             \textcolor{keywordflow}{return}(\textcolor{keyword}{false});
831         \}
832 
833         jsonWifi.printTo(wifiConfig);
834         wifiConfig.close();
835 
836 \textcolor{preprocessor}{#if DEBUG == 1 }
837 
838         Serial.println( F(\textcolor{stringliteral}{"wifi config"}) );
839         jsonWifi.printTo(Serial);
840 
841 \textcolor{preprocessor}{#endif}
842     \}
843     \textcolor{keywordflow}{else}
844     \{
845 
846 \textcolor{preprocessor}{    #if DEBUG == 1 }
847 
848         Serial.println( F(\textcolor{stringliteral}{"failed to parse wifi"}) );
849     
850 \textcolor{preprocessor}{    #endif}
851 
852     
853     \}   
854         
855     \textcolor{keywordflow}{return} \textcolor{keyword}{true};
856 
857 \}   
\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classCoolFileSystem_a32dad79ae80182a83e2e8f52286b7c7b_icgraph}
\end{center}
\end{figure}


\subsection{Member Data Documentation}
\mbox{\Hypertarget{classCoolFileSystem_ad398e0c5c41a0c88acdf5d672aa71351}\label{classCoolFileSystem_ad398e0c5c41a0c88acdf5d672aa71351}} 
\index{Cool\+File\+System@{Cool\+File\+System}!saved\+Data@{saved\+Data}}
\index{saved\+Data@{saved\+Data}!Cool\+File\+System@{Cool\+File\+System}}
\subsubsection{\texorpdfstring{saved\+Data}{savedData}}
{\footnotesize\ttfamily bool Cool\+File\+System\+::saved\+Data =0\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 40 of file Cool\+File\+System.\+h.



Referenced by get\+Sensor\+Saved\+Data(), is\+Data\+Saved(), and save\+Sensor\+Data().



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
/home/ashiroji/\+Arduino/libraries/\+Cool\+Board/\hyperlink{CoolFileSystem_8h}{Cool\+File\+System.\+h}\item 
/home/ashiroji/\+Arduino/libraries/\+Cool\+Board/\hyperlink{CoolFileSystem_8cpp}{Cool\+File\+System.\+cpp}\end{DoxyCompactItemize}
