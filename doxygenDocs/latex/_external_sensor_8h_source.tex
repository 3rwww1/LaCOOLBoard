\hypertarget{_external_sensor_8h_source}{}\section{External\+Sensor.\+h}

\begin{DoxyCode}
00001 
00009 \textcolor{preprocessor}{#ifndef BaseExternalSensor\_H}
00010 \textcolor{preprocessor}{#define BaseExternalSensor\_H}
00011 
00012 \textcolor{preprocessor}{#include<NDIR\_I2C.h>}
00013 \textcolor{preprocessor}{#include<DallasTemperature.h>}
00014 \textcolor{preprocessor}{#include"Arduino.h"}  
00015 
\Hypertarget{_external_sensor_8h_source_l00022}\hyperlink{class_base_external_sensor}{00022} \textcolor{keyword}{class }\hyperlink{class_base_external_sensor}{BaseExternalSensor}
00023 \{
00024 
00025 \textcolor{keyword}{public}:
\Hypertarget{_external_sensor_8h_source_l00030}\hyperlink{class_base_external_sensor_a978d96a6563b646efb358c2790a9fc6f}{00030}     \hyperlink{class_base_external_sensor_a978d96a6563b646efb358c2790a9fc6f}{BaseExternalSensor}()
00031     \{
00032     
00033     \}
\Hypertarget{_external_sensor_8h_source_l00042}\hyperlink{class_base_external_sensor_a87d132803d4f4fdd4e66332809f0c9a0}{00042}     \textcolor{keyword}{virtual} uint8\_t \hyperlink{class_base_external_sensor_a87d132803d4f4fdd4e66332809f0c9a0}{begin}()
00043     \{
00044 
00045         \textcolor{keywordflow}{return}(-2);
00046     \}
00047     
\Hypertarget{_external_sensor_8h_source_l00057}\hyperlink{class_base_external_sensor_a7e0a98f350148d7645031315657aa5ec}{00057}     \textcolor{keyword}{virtual} \textcolor{keywordtype}{int} \hyperlink{class_base_external_sensor_a7e0a98f350148d7645031315657aa5ec}{read}()
00058     \{
00059 
00060         \textcolor{keywordflow}{return}(-1);
00061     \}
00062     
00063 \};
00064 
00065 
00066 
00086 \textcolor{keyword}{template}<\textcolor{keyword}{class} T >
\Hypertarget{_external_sensor_8h_source_l00087}\hyperlink{class_external_sensor}{00087} \textcolor{keyword}{class }\hyperlink{class_external_sensor}{ExternalSensor} : \textcolor{keyword}{public} \hyperlink{class_base_external_sensor}{BaseExternalSensor}
00088 \{
00089 public :
\Hypertarget{_external_sensor_8h_source_l00093}\hyperlink{class_external_sensor_a8b991447fba33253103d06198b838751}{00093}     \hyperlink{class_external_sensor_a8b991447fba33253103d06198b838751}{ExternalSensor}()
00094     \{
00095         sensor();
00096     \}
00097 
\Hypertarget{_external_sensor_8h_source_l00103}\hyperlink{class_external_sensor_ab6fe1379d55b656a048e0fba1e0a32e6}{00103}     \textcolor{keyword}{virtual} uint8\_t \hyperlink{class_external_sensor_ab6fe1379d55b656a048e0fba1e0a32e6}{begin}()
00104     \{
00105 
00106         \textcolor{keywordflow}{return}(sensor.begin() );    
00107     \}
00108     
\Hypertarget{_external_sensor_8h_source_l00112}\hyperlink{class_external_sensor_a6dbf2d6b1c183740ce0f153d6e43ccb2}{00112}     \textcolor{keyword}{virtual} \textcolor{keywordtype}{int} \hyperlink{class_external_sensor_a6dbf2d6b1c183740ce0f153d6e43ccb2}{read}()
00113     \{
00114 
00115         \textcolor{keywordflow}{return}(0);
00116     \}
00117 
00118 
00119 
00120 private :
00121     
00122     T sensor; \textcolor{comment}{//the sensor itself}
00123 
00124 \};
00125 
00132 \textcolor{keyword}{template}<>
\Hypertarget{_external_sensor_8h_source_l00133}\hyperlink{class_external_sensor_3_01_n_d_i_r___i2_c_01_4}{00133} \textcolor{keyword}{class }\hyperlink{class_external_sensor}{ExternalSensor}<NDIR\_I2C> :\textcolor{keyword}{public} \hyperlink{class_base_external_sensor}{BaseExternalSensor}
00134 \{
00135 \textcolor{keyword}{public}:
00136 
\Hypertarget{_external_sensor_8h_source_l00141}\hyperlink{class_external_sensor_3_01_n_d_i_r___i2_c_01_4_aa06970ea689679c0e1deb5360e05a0a4}{00141}     \hyperlink{class_external_sensor_3_01_n_d_i_r___i2_c_01_4_aa06970ea689679c0e1deb5360e05a0a4}{ExternalSensor}(uint8\_t i2c\_addr)
00142     \{
00143         sensor=NDIR\_I2C(i2c\_addr);
00144     \}
00145     
\Hypertarget{_external_sensor_8h_source_l00153}\hyperlink{class_external_sensor_3_01_n_d_i_r___i2_c_01_4_ac6f3614d94968ef0cc11b2b4d69cef03}{00153}     \textcolor{keyword}{virtual} uint8\_t \hyperlink{class_external_sensor_3_01_n_d_i_r___i2_c_01_4_ac6f3614d94968ef0cc11b2b4d69cef03}{begin}()
00154     \{
00155 
00156          \textcolor{keywordflow}{if} (sensor.begin()) 
00157         \{
00158 
00159             delay(10000);
00160             \textcolor{keywordflow}{return}(\textcolor{keyword}{true});
00161             \}
00162          \textcolor{keywordflow}{else} 
00163         \{
00164             \textcolor{keywordflow}{return}(\textcolor{keyword}{false});
00165         \}   
00166     \}
00167     
\Hypertarget{_external_sensor_8h_source_l00175}\hyperlink{class_external_sensor_3_01_n_d_i_r___i2_c_01_4_add67f5ecaf47d2ee675e8299aee7322d}{00175}     \textcolor{keyword}{virtual} \textcolor{keywordtype}{int} \hyperlink{class_external_sensor_3_01_n_d_i_r___i2_c_01_4_add67f5ecaf47d2ee675e8299aee7322d}{read}()
00176     \{
00177 
00178         \textcolor{keywordflow}{if} (sensor.measure())
00179         \{
00180 
00181 
00182             \textcolor{keywordflow}{return}(sensor.ppm);
00183             
00184         \}
00185         
00186         \textcolor{keywordflow}{else}
00187         \{
00188 
00189             \textcolor{keywordflow}{return}(-42);
00190         \}
00191     \}
00192 
00193 \textcolor{keyword}{private}:
00194 
00195     NDIR\_I2C sensor=NULL;
00196 \};
00197 
00204 \textcolor{keyword}{template}<>
\Hypertarget{_external_sensor_8h_source_l00205}\hyperlink{class_external_sensor_3_01_dallas_temperature_01_4}{00205} \textcolor{keyword}{class }\hyperlink{class_external_sensor}{ExternalSensor}<DallasTemperature> :\textcolor{keyword}{public} \hyperlink{class_base_external_sensor}{BaseExternalSensor}
00206 \{
00207 \textcolor{keyword}{public}:
\Hypertarget{_external_sensor_8h_source_l00212}\hyperlink{class_external_sensor_3_01_dallas_temperature_01_4_ad290681e8780cdf1870416eee99d699d}{00212}     \hyperlink{class_external_sensor_3_01_dallas_temperature_01_4_ad290681e8780cdf1870416eee99d699d}{ExternalSensor}()
00213     \{
00214         OneWire oneWire(0);
00215         
00216         sensor=DallasTemperature(&oneWire);
00217     \}
00218     
\Hypertarget{_external_sensor_8h_source_l00225}\hyperlink{class_external_sensor_3_01_dallas_temperature_01_4_ac5275129b05e2ff8df45d5b222a661d9}{00225}     \textcolor{keyword}{virtual} uint8\_t \hyperlink{class_external_sensor_3_01_dallas_temperature_01_4_ac5275129b05e2ff8df45d5b222a661d9}{begin}()
00226     \{
00227         
00228         sensor.begin(); 
00229         delay(5);
00230         sensor.getAddress(this->dallasAddress, 1);  
00231         \textcolor{keywordflow}{return}(\textcolor{keyword}{true});
00232     \}
\Hypertarget{_external_sensor_8h_source_l00239}\hyperlink{class_external_sensor_3_01_dallas_temperature_01_4_a127ead06440ec972c22db2abeb8e2b51}{00239}     \textcolor{keyword}{virtual} \textcolor{keywordtype}{int} \hyperlink{class_external_sensor_3_01_dallas_temperature_01_4_a127ead06440ec972c22db2abeb8e2b51}{read}()
00240     \{
00241          \textcolor{keywordflow}{return}( (\textcolor{keywordtype}{int}) sensor.getTempC(this->dallasAddress) );
00242     \}
00243 
00244 \textcolor{keyword}{private}:
00245 
00246     DallasTemperature sensor=NULL;
00247     DeviceAddress dallasAddress;
00248 \};
00249 
00250 
00251 \textcolor{preprocessor}{#endif}
\end{DoxyCode}
