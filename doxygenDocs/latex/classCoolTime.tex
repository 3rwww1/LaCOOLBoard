\hypertarget{classCoolTime}{}\section{Cool\+Time Class Reference}
\label{classCoolTime}\index{Cool\+Time@{Cool\+Time}}


This class manages the D\+S1337 R\+TC .  




{\ttfamily \#include $<$Cool\+Time.\+h$>$}



Collaboration diagram for Cool\+Time\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=188pt]{classCoolTime__coll__graph}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
bool \hyperlink{classCoolTime_a2b36c4009f083ece2d407fec077c4938}{begin} ()
\item 
bool \hyperlink{classCoolTime_a87c28260c1bc77091162cbcf1ee2e129}{config} ()
\item 
void \hyperlink{classCoolTime_ae5528ed0ba9e78c711084968054950e0}{config} (int \hyperlink{classCoolTime_a1916d98810c2a4e9ba72867e8c1b9a99}{time\+Zone}, I\+P\+Address \hyperlink{classCoolTime_ad2b9858f399108cb440dd1e908916f04}{time\+Server}, unsigned int \hyperlink{classCoolTime_a2f777da44d7ba678be8185299e9b49d1}{local\+Port})
\item 
unsigned long \hyperlink{classCoolTime_a5d17f707a9d337720493b2bce9d41c21}{get\+Last\+Sync\+Time} ()
\item 
time\+\_\+t \hyperlink{classCoolTime_a41fbbbfd651c2079f54d4b2911e4c705}{get\+Ntp\+Time} ()
\item 
void \hyperlink{classCoolTime_a52a1503ad5cb540c71c44cfeceaead8a}{get\+Time\+Date} (int \&year, int \&month, int \&day, int \&hour, int \&minute, int \&second)
\item 
bool \hyperlink{classCoolTime_a5ae038a4498602b189f76a10bf02adf8}{is\+Time\+Sync} (unsigned long seconds=604800)
\item 
void \hyperlink{classCoolTime_af355e7f9b3898211cd2ff25eab5933b1}{print\+Conf} ()
\item 
void \hyperlink{classCoolTime_a236a38d120dc53bc67456d763838c5a1}{send\+N\+T\+Ppacket} (I\+P\+Address \&address)
\item 
void \hyperlink{classCoolTime_ab81ea7fdaace111aa01cc1ec84c6d297}{set\+Date\+Time} (int year, int month, int day, int hour, int minutes, int seconds)
\item 
void \hyperlink{classCoolTime_aae601f795452cfa48d9fb337aed483a8}{update} ()
\end{DoxyCompactItemize}
\subsection*{Private Attributes}
\begin{DoxyCompactItemize}
\item 
unsigned int \hyperlink{classCoolTime_a2f777da44d7ba678be8185299e9b49d1}{local\+Port}
\item 
byte \hyperlink{classCoolTime_a27e6abc82a5c2f72161956967005bec7}{packet\+Buffer} \mbox{[}\hyperlink{CoolTime_8h_a56a6ea64006651b4f42adf713e244f06}{N\+T\+P\+\_\+\+P\+A\+C\+K\+E\+T\+\_\+\+S\+I\+ZE}\mbox{]}
\item 
D\+S1337 \hyperlink{classCoolTime_afa77d58c0c21cfe8b7c27e34d82f07b9}{rtc}
\item 
I\+P\+Address \hyperlink{classCoolTime_ad2b9858f399108cb440dd1e908916f04}{time\+Server}
\item 
unsigned long \hyperlink{classCoolTime_a9d032e76c3470a15b3bbbc52af6463f7}{time\+Sync}
\item 
int \hyperlink{classCoolTime_a1916d98810c2a4e9ba72867e8c1b9a99}{time\+Zone}
\item 
Wi\+Fi\+U\+DP \hyperlink{classCoolTime_a4e23216a8121ca79d0fb019f30884b92}{Udp}
\end{DoxyCompactItemize}


\subsection{Detailed Description}
This class manages the D\+S1337 R\+TC . 

Definition at line 27 of file Cool\+Time.\+h.



\subsection{Member Function Documentation}
\mbox{\Hypertarget{classCoolTime_a2b36c4009f083ece2d407fec077c4938}\label{classCoolTime_a2b36c4009f083ece2d407fec077c4938}} 
\index{Cool\+Time@{Cool\+Time}!begin@{begin}}
\index{begin@{begin}!Cool\+Time@{Cool\+Time}}
\subsubsection{\texorpdfstring{begin()}{begin()}}
{\footnotesize\ttfamily bool Cool\+Time\+::begin (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}

\hyperlink{classCoolTime_a2b36c4009f083ece2d407fec077c4938}{Cool\+Time\+::begin()}\+: This method is provided to init the rtc, the udp connection and the Sync Provider

\begin{DoxyReturn}{Returns}
true if successful,false otherwise 
\end{DoxyReturn}


Definition at line 25 of file Cool\+Time.\+cpp.



References get\+Ntp\+Time(), local\+Port, rtc, and Udp.



Referenced by Cool\+Board\+::begin().


\begin{DoxyCode}
26 \{
27     \textcolor{keywordtype}{bool} trust = \textcolor{keyword}{true};
28 
29     this->\hyperlink{classCoolTime_afa77d58c0c21cfe8b7c27e34d82f07b9}{rtc}.init();                                                          \textcolor{comment}{//initialise DS1337}
30 
31     \textcolor{keywordflow}{if} (!\hyperlink{classCoolTime_afa77d58c0c21cfe8b7c27e34d82f07b9}{rtc}.isRunning()) \{                                                   \textcolor{comment}{//if ever the RTC is
       stopped}
32         trust = \textcolor{keyword}{false};                                                          \textcolor{comment}{//clock is not ok}
33         this->\hyperlink{classCoolTime_afa77d58c0c21cfe8b7c27e34d82f07b9}{rtc}.start();
34 
35     \}
36 
37     \textcolor{keywordflow}{if} (\hyperlink{classCoolTime_afa77d58c0c21cfe8b7c27e34d82f07b9}{rtc}.hasStopped()) \{                                                   \textcolor{comment}{//if the clock has stoped
       one moment or another}
38         trust = \textcolor{keyword}{false};
39     \}
40 
41     \hyperlink{classCoolTime_a4e23216a8121ca79d0fb019f30884b92}{Udp}.begin(\hyperlink{classCoolTime_a2f777da44d7ba678be8185299e9b49d1}{localPort});
42     
43     setSyncProvider(std::bind(&\hyperlink{classCoolTime_a41fbbbfd651c2079f54d4b2911e4c705}{CoolTime::getNtpTime},\textcolor{keyword}{this}));
44 
45     \textcolor{keywordflow}{return}(trust);
46 
47 \}
\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classCoolTime_a2b36c4009f083ece2d407fec077c4938_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=296pt]{classCoolTime_a2b36c4009f083ece2d407fec077c4938_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classCoolTime_a87c28260c1bc77091162cbcf1ee2e129}\label{classCoolTime_a87c28260c1bc77091162cbcf1ee2e129}} 
\index{Cool\+Time@{Cool\+Time}!config@{config}}
\index{config@{config}!Cool\+Time@{Cool\+Time}}
\subsubsection{\texorpdfstring{config()}{config()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily bool Cool\+Time\+::config (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}

\hyperlink{classCoolTime_a87c28260c1bc77091162cbcf1ee2e129}{Cool\+Time\+::config()}\+: This method is provided to configure the \hyperlink{classCoolTime}{Cool\+Time} object through a configuration file.

\begin{DoxyReturn}{Returns}
true if successful,false otherwise 
\end{DoxyReturn}


Definition at line 211 of file Cool\+Time.\+cpp.



References local\+Port, time\+Server, and time\+Zone.



Referenced by Cool\+Board\+::begin(), and Cool\+Board\+::update().


\begin{DoxyCode}
212 \{
213     File rtcConfig = SPIFFS.open(\textcolor{stringliteral}{"/rtcConfig.json"}, \textcolor{stringliteral}{"r"});
214 
215     \textcolor{keywordflow}{if} (!rtcConfig) 
216     \{
217         \textcolor{keywordflow}{return}(\textcolor{keyword}{false});
218     \}
219     \textcolor{keywordflow}{else}
220     \{
221         \textcolor{keywordtype}{size\_t} size = rtcConfig.size();
222         \textcolor{comment}{// Allocate a buffer to store contents of the file.}
223         std::unique\_ptr<char[]> buf(\textcolor{keyword}{new} \textcolor{keywordtype}{char}[size]);
224 
225         rtcConfig.readBytes(buf.get(), size);
226         DynamicJsonBuffer jsonBuffer;
227         JsonObject& json = jsonBuffer.parseObject(buf.get());
228         \textcolor{keywordflow}{if} (!json.success()) 
229         \{
230               \textcolor{keywordflow}{return}(\textcolor{keyword}{false});
231         \} 
232         \textcolor{keywordflow}{else}
233         \{   String ip;
234             
235             \textcolor{keywordflow}{if}(json[\textcolor{stringliteral}{"timeZone"}].success() )
236             \{
237                 this->\hyperlink{classCoolTime_a1916d98810c2a4e9ba72867e8c1b9a99}{timeZone}=json[\textcolor{stringliteral}{"timeZone"}] ;
238             \}
239             \textcolor{keywordflow}{else}
240             \{
241                 this->\hyperlink{classCoolTime_a1916d98810c2a4e9ba72867e8c1b9a99}{timeZone}=this->\hyperlink{classCoolTime_a1916d98810c2a4e9ba72867e8c1b9a99}{timeZone};          
242             \}
243             json[\textcolor{stringliteral}{"timeZone"}]=this->\hyperlink{classCoolTime_a1916d98810c2a4e9ba72867e8c1b9a99}{timeZone};
244             
245             \textcolor{keywordflow}{if}(json[\textcolor{stringliteral}{"timeServer"}].success() )
246             \{           
247                  ip=json[\textcolor{stringliteral}{"timeServer"}].as<String>();
248                 this->\hyperlink{classCoolTime_ad2b9858f399108cb440dd1e908916f04}{timeServer}.fromString(ip);
249                 
250             \}
251             \textcolor{keywordflow}{else}
252             \{
253                 this->\hyperlink{classCoolTime_ad2b9858f399108cb440dd1e908916f04}{timeServer}=this->\hyperlink{classCoolTime_ad2b9858f399108cb440dd1e908916f04}{timeServer};
254             \}
255             json[\textcolor{stringliteral}{"timeServer"}]=ip;
256             
257             \textcolor{keywordflow}{if}(json[\textcolor{stringliteral}{"localPort"}].success() )
258             \{                       
259                 this->\hyperlink{classCoolTime_a2f777da44d7ba678be8185299e9b49d1}{localPort}=json[\textcolor{stringliteral}{"localPort"}];
260             \}
261             \textcolor{keywordflow}{else}
262             \{
263                 this->\hyperlink{classCoolTime_a2f777da44d7ba678be8185299e9b49d1}{localPort}=this->\hyperlink{classCoolTime_a2f777da44d7ba678be8185299e9b49d1}{localPort};
264             \}
265             json[\textcolor{stringliteral}{"localPort"}]=this->\hyperlink{classCoolTime_a2f777da44d7ba678be8185299e9b49d1}{localPort};
266 
267             rtcConfig.close();
268             rtcConfig= SPIFFS.open(\textcolor{stringliteral}{"/rtcConfig.json"}, \textcolor{stringliteral}{"w"});
269             
270             \textcolor{keywordflow}{if}(!rtcConfig)
271             \{
272                 \textcolor{keywordflow}{return}(\textcolor{keyword}{false});
273             \}
274             
275             json.printTo(rtcConfig);
276             rtcConfig.close();
277                         
278             \textcolor{keywordflow}{return}(\textcolor{keyword}{true}); 
279         \}
280     \}   
281 
282 
283 
284 \}
\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classCoolTime_a87c28260c1bc77091162cbcf1ee2e129_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classCoolTime_ae5528ed0ba9e78c711084968054950e0}\label{classCoolTime_ae5528ed0ba9e78c711084968054950e0}} 
\index{Cool\+Time@{Cool\+Time}!config@{config}}
\index{config@{config}!Cool\+Time@{Cool\+Time}}
\subsubsection{\texorpdfstring{config()}{config()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily void Cool\+Time\+::config (\begin{DoxyParamCaption}\item[{int}]{time\+Zone,  }\item[{I\+P\+Address}]{time\+Server,  }\item[{unsigned int}]{local\+Port }\end{DoxyParamCaption})}

Cool\+Time\+::config(time Zone, Time server I\+P , udp Port)\+: This method is provided to do manual configuration. 

Definition at line 196 of file Cool\+Time.\+cpp.



References local\+Port, time\+Server, and time\+Zone.


\begin{DoxyCode}
197 \{
198     this->\hyperlink{classCoolTime_a1916d98810c2a4e9ba72867e8c1b9a99}{timeZone}=\hyperlink{classCoolTime_a1916d98810c2a4e9ba72867e8c1b9a99}{timeZone};
199     this->\hyperlink{classCoolTime_ad2b9858f399108cb440dd1e908916f04}{timeServer}=\hyperlink{classCoolTime_ad2b9858f399108cb440dd1e908916f04}{timeServer};
200     this->\hyperlink{classCoolTime_a2f777da44d7ba678be8185299e9b49d1}{localPort}=\hyperlink{classCoolTime_a2f777da44d7ba678be8185299e9b49d1}{localPort};
201 \} 
\end{DoxyCode}
\mbox{\Hypertarget{classCoolTime_a5d17f707a9d337720493b2bce9d41c21}\label{classCoolTime_a5d17f707a9d337720493b2bce9d41c21}} 
\index{Cool\+Time@{Cool\+Time}!get\+Last\+Sync\+Time@{get\+Last\+Sync\+Time}}
\index{get\+Last\+Sync\+Time@{get\+Last\+Sync\+Time}!Cool\+Time@{Cool\+Time}}
\subsubsection{\texorpdfstring{get\+Last\+Sync\+Time()}{getLastSyncTime()}}
{\footnotesize\ttfamily unsigned long Cool\+Time\+::get\+Last\+Sync\+Time (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}

\hyperlink{classCoolTime_a5d17f707a9d337720493b2bce9d41c21}{Cool\+Time\+::get\+Last\+Sync\+Time()}\+: This method is provided to get the last time we syncronised the time

\begin{DoxyReturn}{Returns}
unsigned long representation of last syncronisation time in seconds 
\end{DoxyReturn}


Definition at line 102 of file Cool\+Time.\+cpp.



References time\+Sync.



Referenced by is\+Time\+Sync().


\begin{DoxyCode}
103 \{
104     \textcolor{keywordflow}{return}(this->\hyperlink{classCoolTime_a9d032e76c3470a15b3bbbc52af6463f7}{timeSync});
105 \}
\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classCoolTime_a5d17f707a9d337720493b2bce9d41c21_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classCoolTime_a41fbbbfd651c2079f54d4b2911e4c705}\label{classCoolTime_a41fbbbfd651c2079f54d4b2911e4c705}} 
\index{Cool\+Time@{Cool\+Time}!get\+Ntp\+Time@{get\+Ntp\+Time}}
\index{get\+Ntp\+Time@{get\+Ntp\+Time}!Cool\+Time@{Cool\+Time}}
\subsubsection{\texorpdfstring{get\+Ntp\+Time()}{getNtpTime()}}
{\footnotesize\ttfamily time\+\_\+t Cool\+Time\+::get\+Ntp\+Time (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}

Cool\+Time\+::get\+Ntop\+Time()\+: This method is provided to get the Time through an N\+TP request to a Time Server

\begin{DoxyReturn}{Returns}
a time\+\_\+t (unsigned long ) timestamp in seconds 
\end{DoxyReturn}


Definition at line 137 of file Cool\+Time.\+cpp.



References N\+T\+P\+\_\+\+P\+A\+C\+K\+E\+T\+\_\+\+S\+I\+ZE, packet\+Buffer, send\+N\+T\+Ppacket(), time\+Server, and Udp.



Referenced by begin(), and update().


\begin{DoxyCode}
138 \{
139     \textcolor{keywordflow}{while} (\hyperlink{classCoolTime_a4e23216a8121ca79d0fb019f30884b92}{Udp}.parsePacket() > 0) ; \textcolor{comment}{// discard any previously received packets}
140 
141     this->\hyperlink{classCoolTime_a236a38d120dc53bc67456d763838c5a1}{sendNTPpacket}(\hyperlink{classCoolTime_ad2b9858f399108cb440dd1e908916f04}{timeServer});
142     uint32\_t beginWait = millis();
143     \textcolor{keywordflow}{while} (millis() - beginWait < 1500) 
144     \{
145         \textcolor{keywordtype}{int} size = this->\hyperlink{classCoolTime_a4e23216a8121ca79d0fb019f30884b92}{Udp}.parsePacket();
146         \textcolor{keywordflow}{if} (size >= \hyperlink{CoolTime_8h_a56a6ea64006651b4f42adf713e244f06}{NTP\_PACKET\_SIZE}) 
147         \{
148             this->\hyperlink{classCoolTime_a4e23216a8121ca79d0fb019f30884b92}{Udp}.read(\hyperlink{classCoolTime_a27e6abc82a5c2f72161956967005bec7}{packetBuffer}, \hyperlink{CoolTime_8h_a56a6ea64006651b4f42adf713e244f06}{NTP\_PACKET\_SIZE});  \textcolor{comment}{// read packet
       into the buffer}
149             \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} secsSince1900;
150             \textcolor{comment}{// convert four bytes starting at location 40 to a long integer}
151             secsSince1900 =  (\textcolor{keywordtype}{unsigned} long)\hyperlink{classCoolTime_a27e6abc82a5c2f72161956967005bec7}{packetBuffer}[40] << 24;
152             secsSince1900 |= (\textcolor{keywordtype}{unsigned} long)\hyperlink{classCoolTime_a27e6abc82a5c2f72161956967005bec7}{packetBuffer}[41] << 16;
153             secsSince1900 |= (\textcolor{keywordtype}{unsigned} long)\hyperlink{classCoolTime_a27e6abc82a5c2f72161956967005bec7}{packetBuffer}[42] << 8;
154             secsSince1900 |= (\textcolor{keywordtype}{unsigned} long)\hyperlink{classCoolTime_a27e6abc82a5c2f72161956967005bec7}{packetBuffer}[43];
155                 \textcolor{keywordflow}{return} secsSince1900 - 2208988800UL;
156 
157 
158         \}
159     \}
160 
161     \textcolor{keywordflow}{return} 0; \textcolor{comment}{// return 0 if unable to get the time}
162 \}
\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classCoolTime_a41fbbbfd651c2079f54d4b2911e4c705_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classCoolTime_a41fbbbfd651c2079f54d4b2911e4c705_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classCoolTime_a52a1503ad5cb540c71c44cfeceaead8a}\label{classCoolTime_a52a1503ad5cb540c71c44cfeceaead8a}} 
\index{Cool\+Time@{Cool\+Time}!get\+Time\+Date@{get\+Time\+Date}}
\index{get\+Time\+Date@{get\+Time\+Date}!Cool\+Time@{Cool\+Time}}
\subsubsection{\texorpdfstring{get\+Time\+Date()}{getTimeDate()}}
{\footnotesize\ttfamily void Cool\+Time\+::get\+Time\+Date (\begin{DoxyParamCaption}\item[{int \&}]{year,  }\item[{int \&}]{month,  }\item[{int \&}]{day,  }\item[{int \&}]{hour,  }\item[{int \&}]{minute,  }\item[{int \&}]{second }\end{DoxyParamCaption})}

Cool\+Time\+::get\+Time\+Date(year,month,day,hour,minute,seconds)\+: This method is provided to get the R\+TC Time 

Definition at line 87 of file Cool\+Time.\+cpp.



References rtc.


\begin{DoxyCode}
88 \{   
89  DS1337::getTime(\hyperlink{classCoolTime_afa77d58c0c21cfe8b7c27e34d82f07b9}{rtc}.getTimestamp(),  year,  month,  day,  hour,  minute,  second);
90     
91 
92 \}
\end{DoxyCode}
\mbox{\Hypertarget{classCoolTime_a5ae038a4498602b189f76a10bf02adf8}\label{classCoolTime_a5ae038a4498602b189f76a10bf02adf8}} 
\index{Cool\+Time@{Cool\+Time}!is\+Time\+Sync@{is\+Time\+Sync}}
\index{is\+Time\+Sync@{is\+Time\+Sync}!Cool\+Time@{Cool\+Time}}
\subsubsection{\texorpdfstring{is\+Time\+Sync()}{isTimeSync()}}
{\footnotesize\ttfamily bool Cool\+Time\+::is\+Time\+Sync (\begin{DoxyParamCaption}\item[{unsigned long}]{seconds = {\ttfamily 604800} }\end{DoxyParamCaption})}

Cool\+Time\+::is\+Time\+Sync( time in seconds)\+: This method is provided to test if the time is syncronised or not. By default we test once per week.

\begin{DoxyReturn}{Returns}
true if time is syncronised,false otherwise 
\end{DoxyReturn}


Definition at line 117 of file Cool\+Time.\+cpp.



References get\+Last\+Sync\+Time(), and rtc.



Referenced by update().


\begin{DoxyCode}
118 \{
119 \textcolor{comment}{//default is once per week we try to get a time update}
120     \textcolor{keywordflow}{if} (this->\hyperlink{classCoolTime_a5d17f707a9d337720493b2bce9d41c21}{getLastSyncTime}() + seconds < \hyperlink{classCoolTime_afa77d58c0c21cfe8b7c27e34d82f07b9}{rtc}.getTimestamp()) 
121     \{           
122         \textcolor{keywordflow}{return}(\textcolor{keyword}{false});
123     \}
124 
125 \textcolor{keywordflow}{return}(\textcolor{keyword}{true});
126 \}
\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classCoolTime_a5ae038a4498602b189f76a10bf02adf8_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classCoolTime_a5ae038a4498602b189f76a10bf02adf8_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classCoolTime_af355e7f9b3898211cd2ff25eab5933b1}\label{classCoolTime_af355e7f9b3898211cd2ff25eab5933b1}} 
\index{Cool\+Time@{Cool\+Time}!print\+Conf@{print\+Conf}}
\index{print\+Conf@{print\+Conf}!Cool\+Time@{Cool\+Time}}
\subsubsection{\texorpdfstring{print\+Conf()}{printConf()}}
{\footnotesize\ttfamily void Cool\+Time\+::print\+Conf (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}

\hyperlink{classCoolTime_af355e7f9b3898211cd2ff25eab5933b1}{Cool\+Time\+::print\+Conf()}\+: This method is provided to print the \hyperlink{classCoolTime}{Cool\+Time} configuration to the Serial Monitor 

Definition at line 292 of file Cool\+Time.\+cpp.



References local\+Port, time\+Server, and time\+Zone.



Referenced by Cool\+Board\+::begin().


\begin{DoxyCode}
293 \{
294     Serial.println(\textcolor{stringliteral}{"RTC Config"}) ;
295     Serial.println(\hyperlink{classCoolTime_a1916d98810c2a4e9ba72867e8c1b9a99}{timeZone});
296     Serial.println(\hyperlink{classCoolTime_ad2b9858f399108cb440dd1e908916f04}{timeServer});
297     Serial.println(\hyperlink{classCoolTime_a2f777da44d7ba678be8185299e9b49d1}{localPort});
298 \}
\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=312pt]{classCoolTime_af355e7f9b3898211cd2ff25eab5933b1_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classCoolTime_a236a38d120dc53bc67456d763838c5a1}\label{classCoolTime_a236a38d120dc53bc67456d763838c5a1}} 
\index{Cool\+Time@{Cool\+Time}!send\+N\+T\+Ppacket@{send\+N\+T\+Ppacket}}
\index{send\+N\+T\+Ppacket@{send\+N\+T\+Ppacket}!Cool\+Time@{Cool\+Time}}
\subsubsection{\texorpdfstring{send\+N\+T\+Ppacket()}{sendNTPpacket()}}
{\footnotesize\ttfamily void Cool\+Time\+::send\+N\+T\+Ppacket (\begin{DoxyParamCaption}\item[{I\+P\+Address \&}]{address }\end{DoxyParamCaption})}

Cool\+Time\+::send\+N\+T\+Ppacket( Time Server I\+P address)\+: This method is provided to send an N\+TP request to the time server at the given address 

Definition at line 169 of file Cool\+Time.\+cpp.



References N\+T\+P\+\_\+\+P\+A\+C\+K\+E\+T\+\_\+\+S\+I\+ZE, packet\+Buffer, and Udp.



Referenced by get\+Ntp\+Time().


\begin{DoxyCode}
170 \{
171     \textcolor{comment}{// set all bytes in the buffer to 0}
172     memset(\hyperlink{classCoolTime_a27e6abc82a5c2f72161956967005bec7}{packetBuffer}, 0, \hyperlink{CoolTime_8h_a56a6ea64006651b4f42adf713e244f06}{NTP\_PACKET\_SIZE});
173     \textcolor{comment}{// Initialize values needed to form NTP request}
174 
175     \hyperlink{classCoolTime_a27e6abc82a5c2f72161956967005bec7}{packetBuffer}[0] = 0b11100011;   \textcolor{comment}{// LI, Version, Mode}
176     \hyperlink{classCoolTime_a27e6abc82a5c2f72161956967005bec7}{packetBuffer}[1] = 0;     \textcolor{comment}{// Stratum, or type of clock}
177     \hyperlink{classCoolTime_a27e6abc82a5c2f72161956967005bec7}{packetBuffer}[2] = 6;     \textcolor{comment}{// Polling Interval}
178     \hyperlink{classCoolTime_a27e6abc82a5c2f72161956967005bec7}{packetBuffer}[3] = 0xEC;  \textcolor{comment}{// Peer Clock Precision}
179     \textcolor{comment}{// 8 bytes of zero for Root Delay & Root Dispersion}
180     \hyperlink{classCoolTime_a27e6abc82a5c2f72161956967005bec7}{packetBuffer}[12]  = 49;
181     \hyperlink{classCoolTime_a27e6abc82a5c2f72161956967005bec7}{packetBuffer}[13]  = 0x4E;
182     \hyperlink{classCoolTime_a27e6abc82a5c2f72161956967005bec7}{packetBuffer}[14]  = 49;
183     \hyperlink{classCoolTime_a27e6abc82a5c2f72161956967005bec7}{packetBuffer}[15]  = 52;
184     \textcolor{comment}{// all NTP fields have been given values, now}
185     \textcolor{comment}{// you can send a packet requesting a timestamp:                 }
186     \hyperlink{classCoolTime_a4e23216a8121ca79d0fb019f30884b92}{Udp}.beginPacket(address, 123); \textcolor{comment}{//NTP requests are to port 123}
187     \hyperlink{classCoolTime_a4e23216a8121ca79d0fb019f30884b92}{Udp}.write(\hyperlink{classCoolTime_a27e6abc82a5c2f72161956967005bec7}{packetBuffer}, \hyperlink{CoolTime_8h_a56a6ea64006651b4f42adf713e244f06}{NTP\_PACKET\_SIZE});
188     \hyperlink{classCoolTime_a4e23216a8121ca79d0fb019f30884b92}{Udp}.endPacket();
189 \}
\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classCoolTime_a236a38d120dc53bc67456d763838c5a1_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classCoolTime_ab81ea7fdaace111aa01cc1ec84c6d297}\label{classCoolTime_ab81ea7fdaace111aa01cc1ec84c6d297}} 
\index{Cool\+Time@{Cool\+Time}!set\+Date\+Time@{set\+Date\+Time}}
\index{set\+Date\+Time@{set\+Date\+Time}!Cool\+Time@{Cool\+Time}}
\subsubsection{\texorpdfstring{set\+Date\+Time()}{setDateTime()}}
{\footnotesize\ttfamily void Cool\+Time\+::set\+Date\+Time (\begin{DoxyParamCaption}\item[{int}]{year,  }\item[{int}]{month,  }\item[{int}]{day,  }\item[{int}]{hour,  }\item[{int}]{minutes,  }\item[{int}]{seconds }\end{DoxyParamCaption})}

Cool\+Time\+::set\+Date\+Time(year,month,dat,hour,minutes,seconds)\+: This method is provided to manually set the R\+Tc Time 

Definition at line 75 of file Cool\+Time.\+cpp.



References rtc.


\begin{DoxyCode}
76 \{
77             this->\hyperlink{classCoolTime_afa77d58c0c21cfe8b7c27e34d82f07b9}{rtc}.setDateTime( year,  month,  day,  hour,  minutes,  seconds);                      
                   \textcolor{comment}{//set RTC to new time}
78 
79 
80 
81 \}
\end{DoxyCode}
\mbox{\Hypertarget{classCoolTime_aae601f795452cfa48d9fb337aed483a8}\label{classCoolTime_aae601f795452cfa48d9fb337aed483a8}} 
\index{Cool\+Time@{Cool\+Time}!update@{update}}
\index{update@{update}!Cool\+Time@{Cool\+Time}}
\subsubsection{\texorpdfstring{update()}{update()}}
{\footnotesize\ttfamily void Cool\+Time\+::update (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}

\hyperlink{classCoolTime_aae601f795452cfa48d9fb337aed483a8}{Cool\+Time\+::update()}\+: This method is provided to correct the rtc Time when it drifts,once every week. 

Definition at line 54 of file Cool\+Time.\+cpp.



References get\+Ntp\+Time(), is\+Time\+Sync(), rtc, and time\+Sync.



Referenced by Cool\+Board\+::on\+Line\+Mode().


\begin{DoxyCode}
55 \{
56     \textcolor{keywordflow}{if}(!this->\hyperlink{classCoolTime_a5ae038a4498602b189f76a10bf02adf8}{isTimeSync}() )
57     \{
58         \textcolor{keywordflow}{if}(timeStatus() != timeNotSet )
59         \{
60 
61             \hyperlink{classCoolTime_afa77d58c0c21cfe8b7c27e34d82f07b9}{rtc}.setDateTime(this->\hyperlink{classCoolTime_a41fbbbfd651c2079f54d4b2911e4c705}{getNtpTime}());
62                 this->\hyperlink{classCoolTime_a9d032e76c3470a15b3bbbc52af6463f7}{timeSync}=this->\hyperlink{classCoolTime_afa77d58c0c21cfe8b7c27e34d82f07b9}{rtc}.getTimestamp();
63             this->\hyperlink{classCoolTime_afa77d58c0c21cfe8b7c27e34d82f07b9}{rtc}.clearOSF();                         \textcolor{comment}{//since the sync worked fine we reset eventual
       error flags in the RTC}
64         \}
65     \}
66     
67     
68 \}
\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classCoolTime_aae601f795452cfa48d9fb337aed483a8_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=331pt]{classCoolTime_aae601f795452cfa48d9fb337aed483a8_icgraph}
\end{center}
\end{figure}


\subsection{Member Data Documentation}
\mbox{\Hypertarget{classCoolTime_a2f777da44d7ba678be8185299e9b49d1}\label{classCoolTime_a2f777da44d7ba678be8185299e9b49d1}} 
\index{Cool\+Time@{Cool\+Time}!local\+Port@{local\+Port}}
\index{local\+Port@{local\+Port}!Cool\+Time@{Cool\+Time}}
\subsubsection{\texorpdfstring{local\+Port}{localPort}}
{\footnotesize\ttfamily unsigned int Cool\+Time\+::local\+Port\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 64 of file Cool\+Time.\+h.



Referenced by begin(), config(), and print\+Conf().

\mbox{\Hypertarget{classCoolTime_a27e6abc82a5c2f72161956967005bec7}\label{classCoolTime_a27e6abc82a5c2f72161956967005bec7}} 
\index{Cool\+Time@{Cool\+Time}!packet\+Buffer@{packet\+Buffer}}
\index{packet\+Buffer@{packet\+Buffer}!Cool\+Time@{Cool\+Time}}
\subsubsection{\texorpdfstring{packet\+Buffer}{packetBuffer}}
{\footnotesize\ttfamily byte Cool\+Time\+::packet\+Buffer\mbox{[}\hyperlink{CoolTime_8h_a56a6ea64006651b4f42adf713e244f06}{N\+T\+P\+\_\+\+P\+A\+C\+K\+E\+T\+\_\+\+S\+I\+ZE}\mbox{]}\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 68 of file Cool\+Time.\+h.



Referenced by get\+Ntp\+Time(), and send\+N\+T\+Ppacket().

\mbox{\Hypertarget{classCoolTime_afa77d58c0c21cfe8b7c27e34d82f07b9}\label{classCoolTime_afa77d58c0c21cfe8b7c27e34d82f07b9}} 
\index{Cool\+Time@{Cool\+Time}!rtc@{rtc}}
\index{rtc@{rtc}!Cool\+Time@{Cool\+Time}}
\subsubsection{\texorpdfstring{rtc}{rtc}}
{\footnotesize\ttfamily D\+S1337 Cool\+Time\+::rtc\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 54 of file Cool\+Time.\+h.



Referenced by begin(), get\+Time\+Date(), is\+Time\+Sync(), set\+Date\+Time(), and update().

\mbox{\Hypertarget{classCoolTime_ad2b9858f399108cb440dd1e908916f04}\label{classCoolTime_ad2b9858f399108cb440dd1e908916f04}} 
\index{Cool\+Time@{Cool\+Time}!time\+Server@{time\+Server}}
\index{time\+Server@{time\+Server}!Cool\+Time@{Cool\+Time}}
\subsubsection{\texorpdfstring{time\+Server}{timeServer}}
{\footnotesize\ttfamily I\+P\+Address Cool\+Time\+::time\+Server\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 60 of file Cool\+Time.\+h.



Referenced by config(), get\+Ntp\+Time(), and print\+Conf().

\mbox{\Hypertarget{classCoolTime_a9d032e76c3470a15b3bbbc52af6463f7}\label{classCoolTime_a9d032e76c3470a15b3bbbc52af6463f7}} 
\index{Cool\+Time@{Cool\+Time}!time\+Sync@{time\+Sync}}
\index{time\+Sync@{time\+Sync}!Cool\+Time@{Cool\+Time}}
\subsubsection{\texorpdfstring{time\+Sync}{timeSync}}
{\footnotesize\ttfamily unsigned long Cool\+Time\+::time\+Sync\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 56 of file Cool\+Time.\+h.



Referenced by get\+Last\+Sync\+Time(), and update().

\mbox{\Hypertarget{classCoolTime_a1916d98810c2a4e9ba72867e8c1b9a99}\label{classCoolTime_a1916d98810c2a4e9ba72867e8c1b9a99}} 
\index{Cool\+Time@{Cool\+Time}!time\+Zone@{time\+Zone}}
\index{time\+Zone@{time\+Zone}!Cool\+Time@{Cool\+Time}}
\subsubsection{\texorpdfstring{time\+Zone}{timeZone}}
{\footnotesize\ttfamily int Cool\+Time\+::time\+Zone\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 58 of file Cool\+Time.\+h.



Referenced by config(), and print\+Conf().

\mbox{\Hypertarget{classCoolTime_a4e23216a8121ca79d0fb019f30884b92}\label{classCoolTime_a4e23216a8121ca79d0fb019f30884b92}} 
\index{Cool\+Time@{Cool\+Time}!Udp@{Udp}}
\index{Udp@{Udp}!Cool\+Time@{Cool\+Time}}
\subsubsection{\texorpdfstring{Udp}{Udp}}
{\footnotesize\ttfamily Wi\+Fi\+U\+DP Cool\+Time\+::\+Udp\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 62 of file Cool\+Time.\+h.



Referenced by begin(), get\+Ntp\+Time(), and send\+N\+T\+Ppacket().



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
\hyperlink{CoolTime_8h}{Cool\+Time.\+h}\item 
\hyperlink{CoolTime_8cpp}{Cool\+Time.\+cpp}\end{DoxyCompactItemize}
