\hypertarget{class_cool_time}{}\section{Cool\+Time Class Reference}
\label{class_cool_time}\index{Cool\+Time@{Cool\+Time}}


This class manages the D\+S1337 R\+TC .  




{\ttfamily \#include $<$Cool\+Time.\+h$>$}



Collaboration diagram for Cool\+Time\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=188pt]{d7/d40/class_cool_time__coll__graph}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{class_cool_time_ab1976cf718b950bc31e003c3323b8adb}{begin} ()
\item 
void \hyperlink{class_cool_time_aae601f795452cfa48d9fb337aed483a8}{update} ()
\item 
bool \hyperlink{class_cool_time_a87c28260c1bc77091162cbcf1ee2e129}{config} ()
\item 
void \hyperlink{class_cool_time_a014656d0d3f74d6391364b92b13e0780}{config} (I\+P\+Address \hyperlink{class_cool_time_ad2b9858f399108cb440dd1e908916f04}{time\+Server}, unsigned int \hyperlink{class_cool_time_a2f777da44d7ba678be8185299e9b49d1}{local\+Port})
\item 
void \hyperlink{class_cool_time_af355e7f9b3898211cd2ff25eab5933b1}{print\+Conf} ()
\item 
void \hyperlink{class_cool_time_ab81ea7fdaace111aa01cc1ec84c6d297}{set\+Date\+Time} (int year, int month, int day, int hour, int minutes, int seconds)
\item 
tm\+Elements\+\_\+t \hyperlink{class_cool_time_a7a7501c5ca77dd1248bea704c44f986c}{get\+Time\+Date} ()
\item 
String \hyperlink{class_cool_time_ac4f32ee513c1328d984306645e8785a4}{get\+E\+S\+Date} ()
\item 
unsigned long \hyperlink{class_cool_time_a5d17f707a9d337720493b2bce9d41c21}{get\+Last\+Sync\+Time} ()
\item 
bool \hyperlink{class_cool_time_a5ae038a4498602b189f76a10bf02adf8}{is\+Time\+Sync} (unsigned long seconds=604800)
\item 
time\+\_\+t \hyperlink{class_cool_time_a41fbbbfd651c2079f54d4b2911e4c705}{get\+Ntp\+Time} ()
\item 
void \hyperlink{class_cool_time_a236a38d120dc53bc67456d763838c5a1}{send\+N\+T\+Ppacket} (I\+P\+Address \&address)
\item 
String \hyperlink{class_cool_time_acd537cd4210d7bde4e1f5c47d2ac0456}{format\+Digits} (int digits)
\item 
bool \hyperlink{class_cool_time_ae9658c9b377510d469e3b88edf33ee85}{save\+Time\+Sync} ()
\end{DoxyCompactItemize}
\subsection*{Private Attributes}
\begin{DoxyCompactItemize}
\item 
unsigned long \hyperlink{class_cool_time_a9d032e76c3470a15b3bbbc52af6463f7}{time\+Sync} =0
\item 
I\+P\+Address \hyperlink{class_cool_time_ad2b9858f399108cb440dd1e908916f04}{time\+Server}
\item 
Wi\+Fi\+U\+DP \hyperlink{class_cool_time_a4e23216a8121ca79d0fb019f30884b92}{Udp}
\item 
unsigned int \hyperlink{class_cool_time_a2f777da44d7ba678be8185299e9b49d1}{local\+Port} =0
\item 
byte \hyperlink{class_cool_time_a27e6abc82a5c2f72161956967005bec7}{packet\+Buffer} \mbox{[}\hyperlink{_cool_time_8h_a56a6ea64006651b4f42adf713e244f06}{N\+T\+P\+\_\+\+P\+A\+C\+K\+E\+T\+\_\+\+S\+I\+ZE}\mbox{]}
\item 
tm\+Elements\+\_\+t \hyperlink{class_cool_time_ad33c2713c903ff064ad09c46406ae088}{tm\+Set}
\item 
D\+S1337\+R\+TC \hyperlink{class_cool_time_abd38f2384ff90692b1568d9db869412e}{rtc}
\end{DoxyCompactItemize}


\subsection{Detailed Description}
This class manages the D\+S1337 R\+TC . 

Definition at line 53 of file Cool\+Time.\+h.



\subsection{Member Function Documentation}
\mbox{\Hypertarget{class_cool_time_ab1976cf718b950bc31e003c3323b8adb}\label{class_cool_time_ab1976cf718b950bc31e003c3323b8adb}} 
\index{Cool\+Time@{Cool\+Time}!begin@{begin}}
\index{begin@{begin}!Cool\+Time@{Cool\+Time}}
\subsubsection{\texorpdfstring{begin()}{begin()}}
{\footnotesize\ttfamily void Cool\+Time\+::begin (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}

\hyperlink{class_cool_time_ab1976cf718b950bc31e003c3323b8adb}{Cool\+Time\+::begin()}\+: This method is provided to init the udp connection 

Definition at line 53 of file Cool\+Time.\+cpp.


\begin{DoxyCode}
54 \{
55 
56 \textcolor{preprocessor}{#if DEBUG == 1 }
57 
58     Serial.println( F(\textcolor{stringliteral}{"Entering CoolTime.begin()"}) );
59     Serial.println();
60 
61 \textcolor{preprocessor}{#endif }
62 
63 
64     \hyperlink{class_cool_time_a4e23216a8121ca79d0fb019f30884b92}{Udp}.begin(\hyperlink{class_cool_time_a2f777da44d7ba678be8185299e9b49d1}{localPort});
65     
66     this->\hyperlink{class_cool_time_aae601f795452cfa48d9fb337aed483a8}{update}();
67     
68 \}
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d6/d49/class_cool_time_ab1976cf718b950bc31e003c3323b8adb_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=296pt]{d6/d49/class_cool_time_ab1976cf718b950bc31e003c3323b8adb_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{class_cool_time_a87c28260c1bc77091162cbcf1ee2e129}\label{class_cool_time_a87c28260c1bc77091162cbcf1ee2e129}} 
\index{Cool\+Time@{Cool\+Time}!config@{config}}
\index{config@{config}!Cool\+Time@{Cool\+Time}}
\subsubsection{\texorpdfstring{config()}{config()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily bool Cool\+Time\+::config (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}

\hyperlink{class_cool_time_a87c28260c1bc77091162cbcf1ee2e129}{Cool\+Time\+::config()}\+: This method is provided to configure the \hyperlink{class_cool_time}{Cool\+Time} object through a configuration file.

\begin{DoxyReturn}{Returns}
true if successful,false otherwise 
\end{DoxyReturn}


Definition at line 426 of file Cool\+Time.\+cpp.


\begin{DoxyCode}
427 \{
428 
429 \textcolor{preprocessor}{#if DEBUG == 1 }
430 
431     Serial.println( F(\textcolor{stringliteral}{"Enter CoolTime.config()"}) );
432     Serial.println();
433 
434 \textcolor{preprocessor}{#endif }
435 
436     File rtcConfig = SPIFFS.open(\textcolor{stringliteral}{"/rtcConfig.json"}, \textcolor{stringliteral}{"r"});
437 
438     \textcolor{keywordflow}{if} (!rtcConfig) 
439     \{
440     
441         Serial.println( F(\textcolor{stringliteral}{"failed to read /rtcConfig.json"}) );
442         Serial.println();
443 
444         \textcolor{keywordflow}{return}(\textcolor{keyword}{false});
445     \}
446     \textcolor{keywordflow}{else}
447     \{
448         \textcolor{keywordtype}{size\_t} size = rtcConfig.size();
449         \textcolor{comment}{// Allocate a buffer to store contents of the file.}
450         std::unique\_ptr<char[]> buf(\textcolor{keyword}{new} \textcolor{keywordtype}{char}[size]);
451 
452         rtcConfig.readBytes(buf.get(), size);
453         DynamicJsonBuffer jsonBuffer;
454         JsonObject& json = jsonBuffer.parseObject(buf.get());
455         \textcolor{keywordflow}{if} (!json.success()) 
456         \{
457 
458             Serial.println( F(\textcolor{stringliteral}{"failed to parse rtcConfig json"}) );
459             Serial.println();
460 
461             \textcolor{keywordflow}{return}(\textcolor{keyword}{false});
462         \} 
463         \textcolor{keywordflow}{else}
464         \{  
465         
466 \textcolor{preprocessor}{        #if DEBUG == 1 }
467 
468             Serial.println( F(\textcolor{stringliteral}{"configuration json is :"}) );
469             json.printTo(Serial);
470             Serial.println();
471 
472             Serial.print(F(\textcolor{stringliteral}{"jsonBuffer size: "}));
473             Serial.println(jsonBuffer.size());
474             Serial.println();
475 
476 
477 \textcolor{preprocessor}{        #endif}
478 
479             String ip;
480             
481             \textcolor{keywordflow}{if}(json[\textcolor{stringliteral}{"timeServer"}].success() )
482             \{           
483                  ip=json[\textcolor{stringliteral}{"timeServer"}].as<String>();
484                 this->\hyperlink{class_cool_time_ad2b9858f399108cb440dd1e908916f04}{timeServer}.fromString(ip);
485                 
486             \}
487             \textcolor{keywordflow}{else}
488             \{
489                 this->\hyperlink{class_cool_time_ad2b9858f399108cb440dd1e908916f04}{timeServer}=this->\hyperlink{class_cool_time_ad2b9858f399108cb440dd1e908916f04}{timeServer};
490             \}
491             json[\textcolor{stringliteral}{"timeServer"}]=ip;
492             
493             \textcolor{keywordflow}{if}(json[\textcolor{stringliteral}{"localPort"}].success() )
494             \{                       
495                 this->\hyperlink{class_cool_time_a2f777da44d7ba678be8185299e9b49d1}{localPort}=json[\textcolor{stringliteral}{"localPort"}];
496             \}
497             \textcolor{keywordflow}{else}
498             \{
499                 this->\hyperlink{class_cool_time_a2f777da44d7ba678be8185299e9b49d1}{localPort}=this->\hyperlink{class_cool_time_a2f777da44d7ba678be8185299e9b49d1}{localPort};
500             \}
501             json[\textcolor{stringliteral}{"localPort"}]=this->\hyperlink{class_cool_time_a2f777da44d7ba678be8185299e9b49d1}{localPort};
502 
503 
504             \textcolor{keywordflow}{if}( json[\textcolor{stringliteral}{"timeSync"}].success() )
505             \{
506 
507                 this->\hyperlink{class_cool_time_a9d032e76c3470a15b3bbbc52af6463f7}{timeSync}=json[\textcolor{stringliteral}{"timeSync"}];
508             \}
509             \textcolor{keywordflow}{else}
510             \{
511                 this->\hyperlink{class_cool_time_a9d032e76c3470a15b3bbbc52af6463f7}{timeSync}=this->\hyperlink{class_cool_time_a9d032e76c3470a15b3bbbc52af6463f7}{timeSync};
512             \}
513             json[\textcolor{stringliteral}{"timeSync"}]=this->\hyperlink{class_cool_time_a9d032e76c3470a15b3bbbc52af6463f7}{timeSync};
514 
515             rtcConfig.close();
516             rtcConfig= SPIFFS.open(\textcolor{stringliteral}{"/rtcConfig.json"}, \textcolor{stringliteral}{"w"});
517             
518             \textcolor{keywordflow}{if}(!rtcConfig)
519             \{
520             
521 \textcolor{preprocessor}{            #if DEBUG == 1}
522 
523                 Serial.println( F(\textcolor{stringliteral}{"failed to write to /rtcConfig.json"}) );
524                 Serial.println();
525             
526 \textcolor{preprocessor}{            #endif}
527 
528                 \textcolor{keywordflow}{return}(\textcolor{keyword}{false});
529             \}
530             
531             json.printTo(rtcConfig);
532             rtcConfig.close();
533 
534 \textcolor{preprocessor}{        #if DEBUG == 1 }
535 
536             Serial.println( F(\textcolor{stringliteral}{"configuration is :"}) );
537             json.printTo(Serial);
538             Serial.println();
539         
540 \textcolor{preprocessor}{        #endif}
541         
542             \textcolor{keywordflow}{return}(\textcolor{keyword}{true}); 
543         \}
544     \}   
545 
546 
547 
548 \}
\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=299pt]{d6/d49/class_cool_time_a87c28260c1bc77091162cbcf1ee2e129_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{class_cool_time_a014656d0d3f74d6391364b92b13e0780}\label{class_cool_time_a014656d0d3f74d6391364b92b13e0780}} 
\index{Cool\+Time@{Cool\+Time}!config@{config}}
\index{config@{config}!Cool\+Time@{Cool\+Time}}
\subsubsection{\texorpdfstring{config()}{config()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily void Cool\+Time\+::config (\begin{DoxyParamCaption}\item[{I\+P\+Address}]{time\+Server,  }\item[{unsigned int}]{local\+Port }\end{DoxyParamCaption})}

Cool\+Time\+::config(\+Time server I\+P , udp Port)\+: This method is provided to do manual configuration. 

Definition at line 403 of file Cool\+Time.\+cpp.


\begin{DoxyCode}
404 \{
405 
406 \textcolor{preprocessor}{#if DEBUG == 1 }
407 
408     Serial.println( F(\textcolor{stringliteral}{"Enter CoomTime.config() , no SPIFFS variant "}) );
409     Serial.println();
410 
411 \textcolor{preprocessor}{#endif }
412 
413     this->\hyperlink{class_cool_time_ad2b9858f399108cb440dd1e908916f04}{timeServer}=\hyperlink{class_cool_time_ad2b9858f399108cb440dd1e908916f04}{timeServer};
414     this->\hyperlink{class_cool_time_a2f777da44d7ba678be8185299e9b49d1}{localPort}=\hyperlink{class_cool_time_a2f777da44d7ba678be8185299e9b49d1}{localPort};
415     
416 \} 
\end{DoxyCode}
\mbox{\Hypertarget{class_cool_time_acd537cd4210d7bde4e1f5c47d2ac0456}\label{class_cool_time_acd537cd4210d7bde4e1f5c47d2ac0456}} 
\index{Cool\+Time@{Cool\+Time}!format\+Digits@{format\+Digits}}
\index{format\+Digits@{format\+Digits}!Cool\+Time@{Cool\+Time}}
\subsubsection{\texorpdfstring{format\+Digits()}{formatDigits()}}
{\footnotesize\ttfamily String Cool\+Time\+::format\+Digits (\begin{DoxyParamCaption}\item[{int}]{digits }\end{DoxyParamCaption})}

Cool\+Time\+::print\+Digits(digit)

utility method for digital clock display adds leading 0

\begin{DoxyReturn}{Returns}
formatted string of the input digit 
\end{DoxyReturn}


Definition at line 707 of file Cool\+Time.\+cpp.


\begin{DoxyCode}
708 \{
709 
710 \textcolor{preprocessor}{#if DEBUG == 1 }
711 
712     Serial.println( F(\textcolor{stringliteral}{"Entering CoolTime.formatDigits()"}) );
713     Serial.println();
714 
715 \textcolor{preprocessor}{#endif }
716 
717     \textcolor{keywordflow}{if}(digits < 10)
718     \{
719     
720 \textcolor{preprocessor}{    #if DEBUG == 1}
721 
722         Serial.println( F(\textcolor{stringliteral}{"output digit : "}) );
723         Serial.println( String(\textcolor{stringliteral}{"0"}) + String(digits) );
724 
725 \textcolor{preprocessor}{    #endif}
726 
727         \textcolor{keywordflow}{return}( String(\textcolor{stringliteral}{"0"}) + String(digits) );
728     \}
729     
730 \textcolor{preprocessor}{#if DEBUG == 1 }
731 
732     Serial.println( F(\textcolor{stringliteral}{"output digit : "}) );
733     Serial.println(digits);
734 
735 \textcolor{preprocessor}{#endif}
736 
737     \textcolor{keywordflow}{return}( String(digits) );
738 \}
\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d6/d49/class_cool_time_acd537cd4210d7bde4e1f5c47d2ac0456_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{class_cool_time_ac4f32ee513c1328d984306645e8785a4}\label{class_cool_time_ac4f32ee513c1328d984306645e8785a4}} 
\index{Cool\+Time@{Cool\+Time}!get\+E\+S\+Date@{get\+E\+S\+Date}}
\index{get\+E\+S\+Date@{get\+E\+S\+Date}!Cool\+Time@{Cool\+Time}}
\subsubsection{\texorpdfstring{get\+E\+S\+Date()}{getESDate()}}
{\footnotesize\ttfamily String Cool\+Time\+::get\+E\+S\+Date (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}

Cool\+Time\+::get\+E\+S\+D()\+: This method is provided to return an Elastic Search compatible date Format

\begin{DoxyReturn}{Returns}
date String in Elastic Search format 
\end{DoxyReturn}


Definition at line 205 of file Cool\+Time.\+cpp.


\begin{DoxyCode}
206 \{
207 
208 \textcolor{preprocessor}{#if DEBUG == 1 }
209 
210     Serial.println( F(\textcolor{stringliteral}{"Entering CoolTime.getESDate()"}) );
211     Serial.println();
212 
213 \textcolor{preprocessor}{#endif }
214 
215     tmElements\_t tm=this->\hyperlink{class_cool_time_a7a7501c5ca77dd1248bea704c44f986c}{getTimeDate}();
216 
217     \textcolor{comment}{//"20yy-mm-ddT00:00:00Z"}
218     String elasticSearchString =String(tm.Year+1970)+\textcolor{stringliteral}{"-"}+this->\hyperlink{class_cool_time_acd537cd4210d7bde4e1f5c47d2ac0456}{formatDigits}(tm.Month)+\textcolor{stringliteral}{"-"};
219 
220     elasticSearchString +=this->\hyperlink{class_cool_time_acd537cd4210d7bde4e1f5c47d2ac0456}{formatDigits}(tm.Day)+\textcolor{stringliteral}{"T"}+this->
      \hyperlink{class_cool_time_acd537cd4210d7bde4e1f5c47d2ac0456}{formatDigits}(tm.Hour)+\textcolor{stringliteral}{":"};
221     
222     elasticSearchString +=this->\hyperlink{class_cool_time_acd537cd4210d7bde4e1f5c47d2ac0456}{formatDigits}(tm.Minute)+\textcolor{stringliteral}{":"}+this->
      \hyperlink{class_cool_time_acd537cd4210d7bde4e1f5c47d2ac0456}{formatDigits}(tm.Second)+\textcolor{stringliteral}{"Z"};
223 
224 \textcolor{preprocessor}{#if DEBUG == 1 }
225 
226     Serial.print( F(\textcolor{stringliteral}{"elastic Search date : "}) );
227     Serial.println(elasticSearchString);
228     Serial.println();
229 
230 \textcolor{preprocessor}{#endif}
231 
232     \textcolor{keywordflow}{return} (elasticSearchString);
233 \}
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d6/d49/class_cool_time_ac4f32ee513c1328d984306645e8785a4_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d6/d49/class_cool_time_ac4f32ee513c1328d984306645e8785a4_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{class_cool_time_a5d17f707a9d337720493b2bce9d41c21}\label{class_cool_time_a5d17f707a9d337720493b2bce9d41c21}} 
\index{Cool\+Time@{Cool\+Time}!get\+Last\+Sync\+Time@{get\+Last\+Sync\+Time}}
\index{get\+Last\+Sync\+Time@{get\+Last\+Sync\+Time}!Cool\+Time@{Cool\+Time}}
\subsubsection{\texorpdfstring{get\+Last\+Sync\+Time()}{getLastSyncTime()}}
{\footnotesize\ttfamily unsigned long Cool\+Time\+::get\+Last\+Sync\+Time (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}

\hyperlink{class_cool_time_a5d17f707a9d337720493b2bce9d41c21}{Cool\+Time\+::get\+Last\+Sync\+Time()}\+: This method is provided to get the last time we syncronised the time

\begin{DoxyReturn}{Returns}
unsigned long representation of last syncronisation time in seconds 
\end{DoxyReturn}


Definition at line 243 of file Cool\+Time.\+cpp.


\begin{DoxyCode}
244 \{
245 
246 \textcolor{preprocessor}{#if DEBUG == 1 }
247 
248     Serial.println( F(\textcolor{stringliteral}{"Entering CoolTime.getLastSyncTime()"}) );
249     Serial.println();
250     
251     Serial.print( F(\textcolor{stringliteral}{"last sync time : "}) );
252     Serial.println(this->\hyperlink{class_cool_time_a9d032e76c3470a15b3bbbc52af6463f7}{timeSync});
253 
254 \textcolor{preprocessor}{#endif }
255 
256     \textcolor{keywordflow}{return}(this->\hyperlink{class_cool_time_a9d032e76c3470a15b3bbbc52af6463f7}{timeSync});
257 \}
\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d6/d49/class_cool_time_a5d17f707a9d337720493b2bce9d41c21_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{class_cool_time_a41fbbbfd651c2079f54d4b2911e4c705}\label{class_cool_time_a41fbbbfd651c2079f54d4b2911e4c705}} 
\index{Cool\+Time@{Cool\+Time}!get\+Ntp\+Time@{get\+Ntp\+Time}}
\index{get\+Ntp\+Time@{get\+Ntp\+Time}!Cool\+Time@{Cool\+Time}}
\subsubsection{\texorpdfstring{get\+Ntp\+Time()}{getNtpTime()}}
{\footnotesize\ttfamily time\+\_\+t Cool\+Time\+::get\+Ntp\+Time (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}

Cool\+Time\+::get\+Ntop\+Time()\+: This method is provided to get the Time through an N\+TP request to a Time Server

\begin{DoxyReturn}{Returns}
a time\+\_\+t (unsigned long ) timestamp in seconds 
\end{DoxyReturn}


Definition at line 309 of file Cool\+Time.\+cpp.


\begin{DoxyCode}
310 \{
311 
312 \textcolor{preprocessor}{#if DEBUG == 1 }
313 
314     Serial.println( F(\textcolor{stringliteral}{"Entering CoolTime.getNtpTime()"}) );
315     Serial.println();
316 
317 \textcolor{preprocessor}{#endif }
318 
319     \textcolor{keywordflow}{while} (\hyperlink{class_cool_time_a4e23216a8121ca79d0fb019f30884b92}{Udp}.parsePacket() > 0) ; \textcolor{comment}{// discard any previously received packets}
320 
321     Serial.println( F(\textcolor{stringliteral}{"Transmit NTP Request"}) );
322 
323     \hyperlink{class_cool_time_a236a38d120dc53bc67456d763838c5a1}{sendNTPpacket}(\hyperlink{class_cool_time_ad2b9858f399108cb440dd1e908916f04}{timeServer});
324 
325     uint32\_t beginWait = millis();
326 
327     \textcolor{keywordflow}{while} (millis() - beginWait < 1500) 
328     \{
329         \textcolor{keywordtype}{int} size = \hyperlink{class_cool_time_a4e23216a8121ca79d0fb019f30884b92}{Udp}.parsePacket();
330         \textcolor{keywordflow}{if} (size >= \hyperlink{_cool_time_8h_a56a6ea64006651b4f42adf713e244f06}{NTP\_PACKET\_SIZE}) 
331         \{
332         
333 \textcolor{preprocessor}{        #if DEBUG == 1}
334 
335             Serial.println( F(\textcolor{stringliteral}{"Receive NTP Response"}) );
336         
337 \textcolor{preprocessor}{        #endif}
338 
339             \hyperlink{class_cool_time_a4e23216a8121ca79d0fb019f30884b92}{Udp}.read(\hyperlink{class_cool_time_a27e6abc82a5c2f72161956967005bec7}{packetBuffer}, \hyperlink{_cool_time_8h_a56a6ea64006651b4f42adf713e244f06}{NTP\_PACKET\_SIZE});  \textcolor{comment}{// read packet into the
       buffer}
340             \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} secsSince1900;
341             \textcolor{comment}{// convert four bytes starting at location 40 to a long integer}
342             secsSince1900 =  (\textcolor{keywordtype}{unsigned} long)\hyperlink{class_cool_time_a27e6abc82a5c2f72161956967005bec7}{packetBuffer}[40] << 24;
343             secsSince1900 |= (\textcolor{keywordtype}{unsigned} long)\hyperlink{class_cool_time_a27e6abc82a5c2f72161956967005bec7}{packetBuffer}[41] << 16;
344             secsSince1900 |= (\textcolor{keywordtype}{unsigned} long)\hyperlink{class_cool_time_a27e6abc82a5c2f72161956967005bec7}{packetBuffer}[42] << 8;
345             secsSince1900 |= (\textcolor{keywordtype}{unsigned} long)\hyperlink{class_cool_time_a27e6abc82a5c2f72161956967005bec7}{packetBuffer}[43];
346         
347 \textcolor{preprocessor}{        #if DEBUG == 1 }
348     
349             Serial.print( F(\textcolor{stringliteral}{"received unix time : "}) );
350             Serial.println(secsSince1900 - 2208988800UL);
351             Serial.println();
352 
353 \textcolor{preprocessor}{        #endif }
354 
355             \textcolor{keywordflow}{return} secsSince1900 - 2208988800UL ;
356         \}
357     \}
358     
359     Serial.println( F(\textcolor{stringliteral}{"No NTP Response :-("}) );
360 
361     \textcolor{keywordflow}{return} 0; \textcolor{comment}{// return 0 if unable to get the time}
362 \}
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d6/d49/class_cool_time_a41fbbbfd651c2079f54d4b2911e4c705_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d6/d49/class_cool_time_a41fbbbfd651c2079f54d4b2911e4c705_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{class_cool_time_a7a7501c5ca77dd1248bea704c44f986c}\label{class_cool_time_a7a7501c5ca77dd1248bea704c44f986c}} 
\index{Cool\+Time@{Cool\+Time}!get\+Time\+Date@{get\+Time\+Date}}
\index{get\+Time\+Date@{get\+Time\+Date}!Cool\+Time@{Cool\+Time}}
\subsubsection{\texorpdfstring{get\+Time\+Date()}{getTimeDate()}}
{\footnotesize\ttfamily tm\+Elements\+\_\+t Cool\+Time\+::get\+Time\+Date (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}

\hyperlink{class_cool_time_a7a7501c5ca77dd1248bea704c44f986c}{Cool\+Time\+::get\+Time\+Date()}\+: This method is provided to get the R\+TC Time

\begin{DoxyReturn}{Returns}
a tm\+Elements\+\_\+t structre that has the time in it 
\end{DoxyReturn}


Definition at line 162 of file Cool\+Time.\+cpp.


\begin{DoxyCode}
163 \{
164 
165 \textcolor{preprocessor}{#if DEBUG == 1 }
166     
167     Serial.println( F(\textcolor{stringliteral}{"Entering CoolTime.getTimeDate()"}) );
168     Serial.println();
169 
170 \textcolor{preprocessor}{#endif}
171 
172     tmElements\_t tm;
173     time\_t timeDate = this->\hyperlink{class_cool_time_abd38f2384ff90692b1568d9db869412e}{rtc}.get(CLOCK\_ADDRESS);
174     breakTime(timeDate,tm);
175 
176 \textcolor{preprocessor}{#if DEBUG == 1}
177     
178     Serial.print( F(\textcolor{stringliteral}{"time is : "}) );
179     Serial.print(tm.Year+ 1970 );
180     Serial.print( F(\textcolor{stringliteral}{"-"}) );
181     Serial.print( this->\hyperlink{class_cool_time_acd537cd4210d7bde4e1f5c47d2ac0456}{formatDigits}( tm.Month ) );
182     Serial.print( F(\textcolor{stringliteral}{"-"}) );
183     Serial.print( this->\hyperlink{class_cool_time_acd537cd4210d7bde4e1f5c47d2ac0456}{formatDigits}( tm.Day ) );
184     Serial.print( F(\textcolor{stringliteral}{"T"}) );
185     Serial.print( this->\hyperlink{class_cool_time_acd537cd4210d7bde4e1f5c47d2ac0456}{formatDigits}( tm.Hour ) );
186     Serial.print( F(\textcolor{stringliteral}{":"}) );
187     Serial.print( this->\hyperlink{class_cool_time_acd537cd4210d7bde4e1f5c47d2ac0456}{formatDigits}( tm.Minute ) );
188     Serial.print( F(\textcolor{stringliteral}{":"}) );
189     Serial.print( this->\hyperlink{class_cool_time_acd537cd4210d7bde4e1f5c47d2ac0456}{formatDigits}( tm.Second ) );
190     Serial.print( F(\textcolor{stringliteral}{"Z"}) );
191 
192 \textcolor{preprocessor}{#endif}
193     
194     \textcolor{keywordflow}{return}(tm);
195 \}
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d6/d49/class_cool_time_a7a7501c5ca77dd1248bea704c44f986c_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d6/d49/class_cool_time_a7a7501c5ca77dd1248bea704c44f986c_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{class_cool_time_a5ae038a4498602b189f76a10bf02adf8}\label{class_cool_time_a5ae038a4498602b189f76a10bf02adf8}} 
\index{Cool\+Time@{Cool\+Time}!is\+Time\+Sync@{is\+Time\+Sync}}
\index{is\+Time\+Sync@{is\+Time\+Sync}!Cool\+Time@{Cool\+Time}}
\subsubsection{\texorpdfstring{is\+Time\+Sync()}{isTimeSync()}}
{\footnotesize\ttfamily bool Cool\+Time\+::is\+Time\+Sync (\begin{DoxyParamCaption}\item[{unsigned long}]{seconds = {\ttfamily 604800} }\end{DoxyParamCaption})}

Cool\+Time\+::is\+Time\+Sync( time in seconds)\+: This method is provided to test if the time is syncronised or not. By default we test once per week.

\begin{DoxyReturn}{Returns}
true if time is syncronised,false otherwise 
\end{DoxyReturn}


Definition at line 269 of file Cool\+Time.\+cpp.


\begin{DoxyCode}
270 \{
271 
272 \textcolor{preprocessor}{#if DEBUG == 1}
273 
274     Serial.println( F(\textcolor{stringliteral}{"Entering CoolTime.isTimeSync() "}) );
275     Serial.println();
276 
277 \textcolor{preprocessor}{#endif }
278 
279 \textcolor{preprocessor}{#if DEBUG == 0}
280 
281     Serial.println( F(\textcolor{stringliteral}{"Check if Clock is ok and in sync..."}));
282 
283 \textcolor{preprocessor}{#endif}
284 
285     \textcolor{comment}{//default is once per week we try to get a time update}
286     \textcolor{keywordflow}{if}( ( RTC.get(CLOCK\_ADDRESS) - this->\hyperlink{class_cool_time_a5d17f707a9d337720493b2bce9d41c21}{getLastSyncTime}() ) > ( seconds ) ) 
287     \{
288 
289         Serial.println( F(\textcolor{stringliteral}{"time is not syncronised "}) );
290     
291         \textcolor{keywordflow}{return}(\textcolor{keyword}{false});  
292     \}
293     
294     Serial.println( F(\textcolor{stringliteral}{"time is syncronised : OK"}) );
295     Serial.println();
296 
297     \textcolor{keywordflow}{return}(\textcolor{keyword}{true});
298 \}
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d6/d49/class_cool_time_a5ae038a4498602b189f76a10bf02adf8_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d6/d49/class_cool_time_a5ae038a4498602b189f76a10bf02adf8_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{class_cool_time_af355e7f9b3898211cd2ff25eab5933b1}\label{class_cool_time_af355e7f9b3898211cd2ff25eab5933b1}} 
\index{Cool\+Time@{Cool\+Time}!print\+Conf@{print\+Conf}}
\index{print\+Conf@{print\+Conf}!Cool\+Time@{Cool\+Time}}
\subsubsection{\texorpdfstring{print\+Conf()}{printConf()}}
{\footnotesize\ttfamily void Cool\+Time\+::print\+Conf (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}

\hyperlink{class_cool_time_af355e7f9b3898211cd2ff25eab5933b1}{Cool\+Time\+::print\+Conf()}\+: This method is provided to print the \hyperlink{class_cool_time}{Cool\+Time} configuration to the Serial Monitor 

Definition at line 680 of file Cool\+Time.\+cpp.


\begin{DoxyCode}
681 \{
682 
683 \textcolor{preprocessor}{#if DEBUG == 1}
684 
685     Serial.println( F(\textcolor{stringliteral}{"Entering CoolTime.printConf()"}) );
686     Serial.println();
687 
688 \textcolor{preprocessor}{#endif }
689 
690     Serial.println(\textcolor{stringliteral}{"RTC Configuration"}) ;
691 
692     Serial.print(\textcolor{stringliteral}{"timeServer : "});
693     Serial.println(\hyperlink{class_cool_time_ad2b9858f399108cb440dd1e908916f04}{timeServer});
694     
695     Serial.print(\textcolor{stringliteral}{"localPort : :"});
696     Serial.println(\hyperlink{class_cool_time_a2f777da44d7ba678be8185299e9b49d1}{localPort});
697 \}
\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=312pt]{d6/d49/class_cool_time_af355e7f9b3898211cd2ff25eab5933b1_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{class_cool_time_ae9658c9b377510d469e3b88edf33ee85}\label{class_cool_time_ae9658c9b377510d469e3b88edf33ee85}} 
\index{Cool\+Time@{Cool\+Time}!save\+Time\+Sync@{save\+Time\+Sync}}
\index{save\+Time\+Sync@{save\+Time\+Sync}!Cool\+Time@{Cool\+Time}}
\subsubsection{\texorpdfstring{save\+Time\+Sync()}{saveTimeSync()}}
{\footnotesize\ttfamily bool Cool\+Time\+::save\+Time\+Sync (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}

\hyperlink{class_cool_time_ae9658c9b377510d469e3b88edf33ee85}{Cool\+Time\+::save\+Time\+Sync()} This method is provided to save the last sync time in the S\+P\+I\+F\+FS.

\begin{DoxyReturn}{Returns}
true if successful,false otherwise 
\end{DoxyReturn}


Definition at line 559 of file Cool\+Time.\+cpp.


\begin{DoxyCode}
560 \{
561     Serial.println( F(\textcolor{stringliteral}{"Enter CoolTime.saveTimeSync()"}) );
562     Serial.println();
563 
564     File rtcConfig = SPIFFS.open(\textcolor{stringliteral}{"/rtcConfig.json"}, \textcolor{stringliteral}{"r"});
565 
566     \textcolor{keywordflow}{if} (!rtcConfig) 
567     \{
568         Serial.println( F(\textcolor{stringliteral}{"failed to read /rtcConfig.json"}) );
569         Serial.println();
570 
571         \textcolor{keywordflow}{return}(\textcolor{keyword}{false});
572     \}
573     \textcolor{keywordflow}{else}
574     \{
575         \textcolor{keywordtype}{size\_t} size = rtcConfig.size();
576         \textcolor{comment}{// Allocate a buffer to store contents of the file.}
577         std::unique\_ptr<char[]> buf(\textcolor{keyword}{new} \textcolor{keywordtype}{char}[size]);
578 
579         rtcConfig.readBytes(buf.get(), size);
580         DynamicJsonBuffer jsonBuffer;
581         JsonObject& json = jsonBuffer.parseObject(buf.get());
582         \textcolor{keywordflow}{if} (!json.success()) 
583         \{
584 
585             Serial.println( F(\textcolor{stringliteral}{"failed to parse json"}) );
586             Serial.println();
587 
588             \textcolor{keywordflow}{return}(\textcolor{keyword}{false});
589         \} 
590         \textcolor{keywordflow}{else}
591         \{
592 
593 \textcolor{preprocessor}{        #if DEBUG == 1}
594     
595             Serial.println( F(\textcolor{stringliteral}{"configuration json is :"}) );
596             json.printTo(Serial);
597             Serial.println();
598 
599             Serial.print(F(\textcolor{stringliteral}{"jsonBuffer size: "}));
600             Serial.println(jsonBuffer.size());
601             Serial.println();
602 
603 \textcolor{preprocessor}{        #endif}
604 
605             String ip;
606                     
607             \textcolor{keywordflow}{if}(json[\textcolor{stringliteral}{"timeServer"}].success() )
608             \{           
609                  ip=json[\textcolor{stringliteral}{"timeServer"}].as<String>();
610                 this->\hyperlink{class_cool_time_ad2b9858f399108cb440dd1e908916f04}{timeServer}.fromString(ip);
611                 
612             \}
613             \textcolor{keywordflow}{else}
614             \{
615                 this->\hyperlink{class_cool_time_ad2b9858f399108cb440dd1e908916f04}{timeServer}=this->\hyperlink{class_cool_time_ad2b9858f399108cb440dd1e908916f04}{timeServer};
616             \}
617             json[\textcolor{stringliteral}{"timeServer"}]=ip;
618             
619             \textcolor{keywordflow}{if}(json[\textcolor{stringliteral}{"localPort"}].success() )
620             \{                       
621                 this->\hyperlink{class_cool_time_a2f777da44d7ba678be8185299e9b49d1}{localPort}=json[\textcolor{stringliteral}{"localPort"}];
622             \}
623             \textcolor{keywordflow}{else}
624             \{
625                 this->\hyperlink{class_cool_time_a2f777da44d7ba678be8185299e9b49d1}{localPort}=this->\hyperlink{class_cool_time_a2f777da44d7ba678be8185299e9b49d1}{localPort};
626             \}
627             json[\textcolor{stringliteral}{"localPort"}]=this->\hyperlink{class_cool_time_a2f777da44d7ba678be8185299e9b49d1}{localPort};
628 
629 
630             \textcolor{keywordflow}{if}( json[\textcolor{stringliteral}{"timeSync"}].success() )
631             \{
632                 json[\textcolor{stringliteral}{"timeSync"}]=this->\hyperlink{class_cool_time_a9d032e76c3470a15b3bbbc52af6463f7}{timeSync};
633             \}
634             \textcolor{keywordflow}{else}
635             \{
636                 this->\hyperlink{class_cool_time_a9d032e76c3470a15b3bbbc52af6463f7}{timeSync}=this->\hyperlink{class_cool_time_a9d032e76c3470a15b3bbbc52af6463f7}{timeSync};
637             \}
638             json[\textcolor{stringliteral}{"timeSync"}]=this->\hyperlink{class_cool_time_a9d032e76c3470a15b3bbbc52af6463f7}{timeSync};
639 
640 
641             rtcConfig.close();
642             rtcConfig= SPIFFS.open(\textcolor{stringliteral}{"/rtcConfig.json"}, \textcolor{stringliteral}{"w"});
643             
644             \textcolor{keywordflow}{if}(!rtcConfig)
645             \{
646 \textcolor{preprocessor}{            #if DEBUG == 1}
647 
648                 Serial.println( F(\textcolor{stringliteral}{"failed to write timeSync to /rtcConfig.json"}) );
649                 Serial.println();
650             
651 \textcolor{preprocessor}{            #endif}
652 
653                 \textcolor{keywordflow}{return}(\textcolor{keyword}{false});
654             \}
655             
656             json.printTo(rtcConfig);
657             rtcConfig.close();
658     
659 \textcolor{preprocessor}{        #if DEBUG == 1}
660 
661             Serial.println( F(\textcolor{stringliteral}{"configuration is :"}) );
662             json.printTo(Serial);
663             Serial.println();
664         
665 \textcolor{preprocessor}{        #endif}
666             \textcolor{keywordflow}{return}(\textcolor{keyword}{true}); 
667         \}
668     \}   
669 
670 
671 
672 \}
\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d6/d49/class_cool_time_ae9658c9b377510d469e3b88edf33ee85_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{class_cool_time_a236a38d120dc53bc67456d763838c5a1}\label{class_cool_time_a236a38d120dc53bc67456d763838c5a1}} 
\index{Cool\+Time@{Cool\+Time}!send\+N\+T\+Ppacket@{send\+N\+T\+Ppacket}}
\index{send\+N\+T\+Ppacket@{send\+N\+T\+Ppacket}!Cool\+Time@{Cool\+Time}}
\subsubsection{\texorpdfstring{send\+N\+T\+Ppacket()}{sendNTPpacket()}}
{\footnotesize\ttfamily void Cool\+Time\+::send\+N\+T\+Ppacket (\begin{DoxyParamCaption}\item[{I\+P\+Address \&}]{address }\end{DoxyParamCaption})}

Cool\+Time\+::send\+N\+T\+Ppacket( Time Server I\+P address)\+: This method is provided to send an N\+TP request to the time server at the given address 

Definition at line 369 of file Cool\+Time.\+cpp.


\begin{DoxyCode}
370 \{
371 
372 \textcolor{preprocessor}{#if DEBUG == 1 }
373 
374     Serial.println( F(\textcolor{stringliteral}{"Enter CoolTime.sendNTPpacket()"}) );
375     Serial.println();
376 
377 \textcolor{preprocessor}{#endif}
378 
379     memset(\hyperlink{class_cool_time_a27e6abc82a5c2f72161956967005bec7}{packetBuffer}, 0, \hyperlink{_cool_time_8h_a56a6ea64006651b4f42adf713e244f06}{NTP\_PACKET\_SIZE});
380     \textcolor{comment}{// Initialize values needed to form NTP request}
381     \textcolor{comment}{// (see URL above for details on the packets)}
382     \hyperlink{class_cool_time_a27e6abc82a5c2f72161956967005bec7}{packetBuffer}[0] = 0b11100011;   \textcolor{comment}{// LI, Version, Mode}
383     \hyperlink{class_cool_time_a27e6abc82a5c2f72161956967005bec7}{packetBuffer}[1] = 0;     \textcolor{comment}{// Stratum, or type of clock}
384     \hyperlink{class_cool_time_a27e6abc82a5c2f72161956967005bec7}{packetBuffer}[2] = 6;     \textcolor{comment}{// Polling Interval}
385     \hyperlink{class_cool_time_a27e6abc82a5c2f72161956967005bec7}{packetBuffer}[3] = 0xEC;  \textcolor{comment}{// Peer Clock Precision}
386     \textcolor{comment}{// 8 bytes of zero for Root Delay & Root Dispersion}
387     \hyperlink{class_cool_time_a27e6abc82a5c2f72161956967005bec7}{packetBuffer}[12]  = 49;
388     \hyperlink{class_cool_time_a27e6abc82a5c2f72161956967005bec7}{packetBuffer}[13]  = 0x4E;
389     \hyperlink{class_cool_time_a27e6abc82a5c2f72161956967005bec7}{packetBuffer}[14]  = 49;
390     \hyperlink{class_cool_time_a27e6abc82a5c2f72161956967005bec7}{packetBuffer}[15]  = 52;
391     \textcolor{comment}{// all NTP fields have been given values, now}
392     \textcolor{comment}{// you can send a packet requesting a timestamp:                 }
393     \hyperlink{class_cool_time_a4e23216a8121ca79d0fb019f30884b92}{Udp}.beginPacket(address, 123); \textcolor{comment}{//NTP requests are to port 123}
394     \hyperlink{class_cool_time_a4e23216a8121ca79d0fb019f30884b92}{Udp}.write(\hyperlink{class_cool_time_a27e6abc82a5c2f72161956967005bec7}{packetBuffer}, \hyperlink{_cool_time_8h_a56a6ea64006651b4f42adf713e244f06}{NTP\_PACKET\_SIZE});
395     \hyperlink{class_cool_time_a4e23216a8121ca79d0fb019f30884b92}{Udp}.endPacket(); 
396 \}
\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d6/d49/class_cool_time_a236a38d120dc53bc67456d763838c5a1_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{class_cool_time_ab81ea7fdaace111aa01cc1ec84c6d297}\label{class_cool_time_ab81ea7fdaace111aa01cc1ec84c6d297}} 
\index{Cool\+Time@{Cool\+Time}!set\+Date\+Time@{set\+Date\+Time}}
\index{set\+Date\+Time@{set\+Date\+Time}!Cool\+Time@{Cool\+Time}}
\subsubsection{\texorpdfstring{set\+Date\+Time()}{setDateTime()}}
{\footnotesize\ttfamily void Cool\+Time\+::set\+Date\+Time (\begin{DoxyParamCaption}\item[{int}]{year,  }\item[{int}]{month,  }\item[{int}]{day,  }\item[{int}]{hour,  }\item[{int}]{minutes,  }\item[{int}]{seconds }\end{DoxyParamCaption})}

Cool\+Time\+::set\+Date\+Time(year,month,dat,hour,minutes,seconds)\+: This method is provided to manually set the R\+Tc Time 

Definition at line 108 of file Cool\+Time.\+cpp.


\begin{DoxyCode}
109 \{ 
110 
111 \textcolor{preprocessor}{#if DEBUG == 1}
112 
113     Serial.println( F(\textcolor{stringliteral}{"Entering CoolTime.setDateTime"}) );
114     Serial.println();
115 
116 \textcolor{preprocessor}{#endif}
117 
118     tmElements\_t tm;
119     tm.Second=seconds; 
120     tm.Minute=minutes; 
121     tm.Hour=hour; 
122     tm.Day=day;
123     tm.Month=month; 
124     tm.Year=year;
125     
126     this->\hyperlink{class_cool_time_abd38f2384ff90692b1568d9db869412e}{rtc}.set(makeTime(tm),CLOCK\_ADDRESS);   
127 
128 \textcolor{preprocessor}{#if DEBUG == 1}
129 
130     Serial.print( F(\textcolor{stringliteral}{"setting time to : "}) );\textcolor{comment}{//"20yy-mm-ddT00:00:00Z}
131 
132     Serial.print(tm.Year);
133     Serial.print( F(\textcolor{stringliteral}{"-"}) );
134     Serial.print( this->\hyperlink{class_cool_time_acd537cd4210d7bde4e1f5c47d2ac0456}{formatDigits}( tm.Month ) );
135     Serial.print( F(\textcolor{stringliteral}{"-"}) );
136     Serial.print( this->\hyperlink{class_cool_time_acd537cd4210d7bde4e1f5c47d2ac0456}{formatDigits}( tm.Day ) );
137     Serial.print( F(\textcolor{stringliteral}{"T"}) );
138     Serial.print( this->\hyperlink{class_cool_time_acd537cd4210d7bde4e1f5c47d2ac0456}{formatDigits}( tm.Hour ) );
139     Serial.print( F(\textcolor{stringliteral}{":"}) );
140     Serial.print( this->\hyperlink{class_cool_time_acd537cd4210d7bde4e1f5c47d2ac0456}{formatDigits}( tm.Minute ) );
141     Serial.print( F(\textcolor{stringliteral}{":"}) );
142     Serial.print( this->\hyperlink{class_cool_time_acd537cd4210d7bde4e1f5c47d2ac0456}{formatDigits}( tm.Second ) );
143     Serial.print( F(\textcolor{stringliteral}{"Z"}) );
144 
145     Serial.println();
146     
147     Serial.print( F(\textcolor{stringliteral}{"time set to : "}) );
148     Serial.println(this->\hyperlink{class_cool_time_ac4f32ee513c1328d984306645e8785a4}{getESDate}());
149     Serial.println();
150 
151 \textcolor{preprocessor}{#endif}
152 
153 \}
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d6/d49/class_cool_time_ab81ea7fdaace111aa01cc1ec84c6d297_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{class_cool_time_aae601f795452cfa48d9fb337aed483a8}\label{class_cool_time_aae601f795452cfa48d9fb337aed483a8}} 
\index{Cool\+Time@{Cool\+Time}!update@{update}}
\index{update@{update}!Cool\+Time@{Cool\+Time}}
\subsubsection{\texorpdfstring{update()}{update()}}
{\footnotesize\ttfamily void Cool\+Time\+::update (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}

\hyperlink{class_cool_time_aae601f795452cfa48d9fb337aed483a8}{Cool\+Time\+::update()}\+: This method is provided to correct the rtc Time when it drifts,once every week. 

Definition at line 75 of file Cool\+Time.\+cpp.


\begin{DoxyCode}
76 \{
77 
78 \textcolor{preprocessor}{#if DEBUG == 1}
79 
80     Serial.println( F(\textcolor{stringliteral}{"Entering CoolTime.update()"}) );
81     Serial.println();
82 
83 \textcolor{preprocessor}{#endif }
84 
85     \textcolor{keywordflow}{if}( !( this->\hyperlink{class_cool_time_a5ae038a4498602b189f76a10bf02adf8}{isTimeSync}() ) )
86     \{
87     
88 \textcolor{preprocessor}{    #if DEBUG == 1}
89 
90         Serial.println( F(\textcolor{stringliteral}{"waiting for sync"}) );
91         Serial.println();
92 
93 \textcolor{preprocessor}{    #endif }
94 
95         this->\hyperlink{class_cool_time_a9d032e76c3470a15b3bbbc52af6463f7}{timeSync}=this->\hyperlink{class_cool_time_a41fbbbfd651c2079f54d4b2911e4c705}{getNtpTime}();
96         breakTime(this->\hyperlink{class_cool_time_a41fbbbfd651c2079f54d4b2911e4c705}{getNtpTime}(), this->\hyperlink{class_cool_time_ad33c2713c903ff064ad09c46406ae088}{tmSet});
97         this->\hyperlink{class_cool_time_abd38f2384ff90692b1568d9db869412e}{rtc}.set(makeTime(this->\hyperlink{class_cool_time_ad33c2713c903ff064ad09c46406ae088}{tmSet}), CLOCK\_ADDRESS); \textcolor{comment}{// set the clock}
98         this->\hyperlink{class_cool_time_ae9658c9b377510d469e3b88edf33ee85}{saveTimeSync}();
99     \}
100     
101 \}
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d6/d49/class_cool_time_aae601f795452cfa48d9fb337aed483a8_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d6/d49/class_cool_time_aae601f795452cfa48d9fb337aed483a8_icgraph}
\end{center}
\end{figure}


\subsection{Member Data Documentation}
\mbox{\Hypertarget{class_cool_time_a2f777da44d7ba678be8185299e9b49d1}\label{class_cool_time_a2f777da44d7ba678be8185299e9b49d1}} 
\index{Cool\+Time@{Cool\+Time}!local\+Port@{local\+Port}}
\index{local\+Port@{local\+Port}!Cool\+Time@{Cool\+Time}}
\subsubsection{\texorpdfstring{local\+Port}{localPort}}
{\footnotesize\ttfamily unsigned int Cool\+Time\+::local\+Port =0\hspace{0.3cm}{\ttfamily [private]}}

port number for U\+DP packets 

Definition at line 106 of file Cool\+Time.\+h.

\mbox{\Hypertarget{class_cool_time_a27e6abc82a5c2f72161956967005bec7}\label{class_cool_time_a27e6abc82a5c2f72161956967005bec7}} 
\index{Cool\+Time@{Cool\+Time}!packet\+Buffer@{packet\+Buffer}}
\index{packet\+Buffer@{packet\+Buffer}!Cool\+Time@{Cool\+Time}}
\subsubsection{\texorpdfstring{packet\+Buffer}{packetBuffer}}
{\footnotesize\ttfamily byte Cool\+Time\+::packet\+Buffer\mbox{[}\hyperlink{_cool_time_8h_a56a6ea64006651b4f42adf713e244f06}{N\+T\+P\+\_\+\+P\+A\+C\+K\+E\+T\+\_\+\+S\+I\+ZE}\mbox{]}\hspace{0.3cm}{\ttfamily [private]}}

U\+DP buffer to hold incoming \& outgoing packets 

Definition at line 112 of file Cool\+Time.\+h.

\mbox{\Hypertarget{class_cool_time_abd38f2384ff90692b1568d9db869412e}\label{class_cool_time_abd38f2384ff90692b1568d9db869412e}} 
\index{Cool\+Time@{Cool\+Time}!rtc@{rtc}}
\index{rtc@{rtc}!Cool\+Time@{Cool\+Time}}
\subsubsection{\texorpdfstring{rtc}{rtc}}
{\footnotesize\ttfamily D\+S1337\+R\+TC Cool\+Time\+::rtc\hspace{0.3cm}{\ttfamily [private]}}

R\+TC instance 

Definition at line 122 of file Cool\+Time.\+h.

\mbox{\Hypertarget{class_cool_time_ad2b9858f399108cb440dd1e908916f04}\label{class_cool_time_ad2b9858f399108cb440dd1e908916f04}} 
\index{Cool\+Time@{Cool\+Time}!time\+Server@{time\+Server}}
\index{time\+Server@{time\+Server}!Cool\+Time@{Cool\+Time}}
\subsubsection{\texorpdfstring{time\+Server}{timeServer}}
{\footnotesize\ttfamily I\+P\+Address Cool\+Time\+::time\+Server\hspace{0.3cm}{\ttfamily [private]}}

N\+TP Server IP Address 

Definition at line 96 of file Cool\+Time.\+h.

\mbox{\Hypertarget{class_cool_time_a9d032e76c3470a15b3bbbc52af6463f7}\label{class_cool_time_a9d032e76c3470a15b3bbbc52af6463f7}} 
\index{Cool\+Time@{Cool\+Time}!time\+Sync@{time\+Sync}}
\index{time\+Sync@{time\+Sync}!Cool\+Time@{Cool\+Time}}
\subsubsection{\texorpdfstring{time\+Sync}{timeSync}}
{\footnotesize\ttfamily unsigned long Cool\+Time\+::time\+Sync =0\hspace{0.3cm}{\ttfamily [private]}}

last Time the R\+TC syncronised with the N\+TP server unix Time 

Definition at line 91 of file Cool\+Time.\+h.

\mbox{\Hypertarget{class_cool_time_ad33c2713c903ff064ad09c46406ae088}\label{class_cool_time_ad33c2713c903ff064ad09c46406ae088}} 
\index{Cool\+Time@{Cool\+Time}!tm\+Set@{tm\+Set}}
\index{tm\+Set@{tm\+Set}!Cool\+Time@{Cool\+Time}}
\subsubsection{\texorpdfstring{tm\+Set}{tmSet}}
{\footnotesize\ttfamily tm\+Elements\+\_\+t Cool\+Time\+::tm\+Set\hspace{0.3cm}{\ttfamily [private]}}

Time Elements Instance to hold various Time Values 

Definition at line 117 of file Cool\+Time.\+h.

\mbox{\Hypertarget{class_cool_time_a4e23216a8121ca79d0fb019f30884b92}\label{class_cool_time_a4e23216a8121ca79d0fb019f30884b92}} 
\index{Cool\+Time@{Cool\+Time}!Udp@{Udp}}
\index{Udp@{Udp}!Cool\+Time@{Cool\+Time}}
\subsubsection{\texorpdfstring{Udp}{Udp}}
{\footnotesize\ttfamily Wi\+Fi\+U\+DP Cool\+Time\+::\+Udp\hspace{0.3cm}{\ttfamily [private]}}

U\+DP Client instance 

Definition at line 101 of file Cool\+Time.\+h.



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
/home/ashiroji/\+Arduino/libraries/\+Cool\+Board/src/\hyperlink{_cool_time_8h}{Cool\+Time.\+h}\item 
/home/ashiroji/\+Arduino/libraries/\+Cool\+Board/src/\hyperlink{_cool_time_8cpp}{Cool\+Time.\+cpp}\end{DoxyCompactItemize}
